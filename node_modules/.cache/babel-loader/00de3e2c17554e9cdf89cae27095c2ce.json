{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n\nimport { append, createElement, formatUnit, EventHandler, addClass, remove, extend, Browser, isNullOrUndefined, removeClass, closest, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { MobileLayout } from './mobile-layout';\nimport * as events from '../base/constant';\nimport * as cls from '../base/css-constant';\n/**\n * Kanban layout rendering module\n *\n */\n\nvar LayoutRender =\n/** @class */\nfunction (_super) {\n  __extends(LayoutRender, _super);\n\n  function LayoutRender(parent) {\n    var _this = _super.call(this, parent) || this;\n\n    _this.kanbanRows = [];\n    _this.parent = parent;\n    _this.columnKeys = [];\n    _this.swimlaneIndex = 0;\n    _this.swimlaneData = {};\n    _this.scrollLeft = 0;\n    _this.frozenOrder = 0;\n\n    _this.parent.on(events.dataReady, _this.initRender, _this);\n\n    _this.parent.on(events.contentReady, _this.scrollUiUpdate, _this);\n\n    return _this;\n  }\n\n  LayoutRender.prototype.initRender = function () {\n    if (this.parent.columns.length === 0) {\n      return;\n    }\n\n    this.columnData = this.getColumnCards();\n    this.kanbanRows = this.getRows();\n    this.swimlaneData = this.getSwimlaneCards();\n\n    if (this.parent.isAdaptive) {\n      var parent_1 = this.parent.element.querySelector('.' + cls.CONTENT_CLASS);\n\n      if (parent_1) {\n        this.scrollLeft = parent_1.scrollLeft;\n      }\n    }\n\n    this.destroy();\n    this.parent.on(events.dataReady, this.initRender, this);\n    this.parent.on(events.contentReady, this.scrollUiUpdate, this);\n\n    if (this.parent.isAdaptive && this.parent.swimlaneSettings.keyField && this.parent.kanbanData.length !== 0) {\n      this.renderSwimlaneHeader();\n    }\n\n    var header = createElement('div', {\n      className: cls.HEADER_CLASS\n    });\n    this.parent.element.appendChild(header);\n    this.renderHeader(header);\n    this.renderContent();\n    this.renderCards();\n    this.renderValidation();\n    this.parent.renderTemplates();\n    this.parent.notify(events.contentReady, {});\n    this.wireEvents();\n\n    if (this.parent.isInitialRender) {\n      this.parent.isInitialRender = false;\n    }\n  };\n\n  LayoutRender.prototype.renderHeader = function (header) {\n    var headerWrap = createElement('div', {\n      className: this.parent.swimlaneSettings.keyField ? cls.SWIMLANE_CLASS : ''\n    });\n    header.appendChild(headerWrap);\n    var headerTable = createElement('table', {\n      className: cls.TABLE_CLASS + ' ' + cls.HEADER_TABLE_CLASS,\n      attrs: {\n        'role': 'presentation'\n      }\n    });\n    headerWrap.appendChild(headerTable);\n    this.renderColGroup(headerTable);\n    var tableHead = createElement('thead');\n    headerTable.appendChild(tableHead);\n\n    if (this.parent.stackedHeaders.length > 0) {\n      tableHead.appendChild(this.createStackedRow(this.parent.stackedHeaders));\n    }\n\n    var tr = createElement('tr', {\n      className: cls.HEADER_ROW_CLASS\n    });\n    tableHead.appendChild(tr);\n\n    var _loop_1 = function (column) {\n      if (this_1.isColumnVisible(column)) {\n        var index = this_1.parent.actionModule.columnToggleArray.indexOf(column.keyField.toString());\n        var th_1 = createElement('th', {\n          className: index === -1 ? cls.HEADER_CELLS_CLASS : cls.HEADER_CELLS_CLASS + ' ' + cls.COLLAPSED_CLASS,\n          attrs: {\n            'data-role': 'kanban-column',\n            'data-key': column.keyField.toString()\n          }\n        });\n        var classList = [];\n\n        if (column.allowToggle) {\n          classList.push(cls.HEADER_ROW_TOGGLE_CLASS);\n\n          if (!column.isExpanded) {\n            classList.push(cls.COLLAPSED_CLASS);\n          }\n        }\n\n        addClass([th_1], classList);\n        var headerWrapper = createElement('div', {\n          className: cls.HEADER_WRAP_CLASS\n        });\n        th_1.appendChild(headerWrapper);\n        var noOfCard = this_1.columnData[column.keyField].length;\n        var headerTitle = createElement('div', {\n          className: cls.HEADER_TITLE_CLASS\n        });\n        headerWrapper.appendChild(headerTitle);\n\n        if (column.template) {\n          var templateArgs = {\n            keyField: column.keyField,\n            headerText: column.headerText,\n            minCount: column.minCount,\n            maxCount: column.maxCount,\n            allowToggle: column.allowToggle,\n            isExpanded: column.isExpanded,\n            showItemCount: column.showItemCount,\n            count: noOfCard\n          };\n          addClass([th_1], cls.TEMPLATE_CLASS);\n          var templateId = this_1.parent.element.id + '_columnTemplate';\n          var templateHeader = this_1.parent.templateParser(column.template)(templateArgs, this_1.parent, 'columnTemplate', templateId, false);\n          append(templateHeader, headerTitle);\n        } else {\n          var header_1 = createElement('div', {\n            className: cls.HEADER_TEXT_CLASS,\n            innerHTML: column.headerText\n          });\n          headerTitle.appendChild(header_1);\n\n          if (column.showItemCount) {\n            var itemCount = createElement('div', {\n              className: cls.CARD_ITEM_COUNT_CLASS,\n              innerHTML: '- ' + noOfCard.toString() + ' ' + this_1.parent.localeObj.getConstant('items')\n            });\n            headerTitle.appendChild(itemCount);\n          }\n        }\n\n        if (column.allowToggle) {\n          var isExpand = column.isExpanded && index === -1 ? true : false;\n          var name_1 = isExpand ? cls.COLUMN_EXPAND_CLASS : cls.COLUMN_COLLAPSE_CLASS;\n          var icon = createElement('div', {\n            className: cls.HEADER_ICON_CLASS + ' ' + cls.ICON_CLASS + ' ' + name_1,\n            attrs: {\n              'tabindex': '0'\n            }\n          });\n          icon.setAttribute('aria-label', isExpand ? column.keyField + ' Expand' : column.keyField + ' Collapse');\n          th_1.setAttribute('aria-expanded', isExpand.toString());\n          headerWrapper.appendChild(icon);\n        }\n\n        var dataObj = [{\n          keyField: column.keyField,\n          textField: column.headerText,\n          count: noOfCard\n        }];\n        var args = {\n          data: dataObj,\n          element: tr,\n          cancel: false,\n          requestType: 'headerRow'\n        };\n        this_1.parent.trigger(events.queryCellInfo, args, function (columnArgs) {\n          if (!columnArgs.cancel) {\n            tr.appendChild(th_1);\n          }\n        });\n      }\n    };\n\n    var this_1 = this;\n\n    for (var _i = 0, _a = this.parent.columns; _i < _a.length; _i++) {\n      var column = _a[_i];\n\n      _loop_1(column);\n    }\n  };\n\n  LayoutRender.prototype.renderContent = function () {\n    var content = createElement('div', {\n      className: cls.CONTENT_CLASS\n    });\n    this.parent.element.appendChild(content);\n    var contentWrap = createElement('div', {\n      className: this.parent.swimlaneSettings.keyField ? cls.SWIMLANE_CLASS : ''\n    });\n    content.appendChild(contentWrap);\n    var contentTable = createElement('table', {\n      className: cls.TABLE_CLASS + ' ' + cls.CONTENT_TABLE_CLASS,\n      attrs: {\n        'role': 'presentation'\n      }\n    });\n    contentWrap.appendChild(contentTable);\n    this.renderColGroup(contentTable);\n    var tBody = createElement('tbody');\n    contentTable.appendChild(tBody);\n    var className;\n    var isCollaspsed = false;\n    this.swimlaneRow = this.kanbanRows;\n    this.initializeSwimlaneTree();\n\n    for (var _i = 0, _a = this.swimlaneRow; _i < _a.length; _i++) {\n      var row = _a[_i];\n\n      if (this.parent.swimlaneSettings.keyField && this.parent.swimlaneToggleArray.length !== 0) {\n        var index = this.parent.swimlaneToggleArray.indexOf(row.keyField);\n        isCollaspsed = index !== -1;\n      }\n\n      if (this.parent.swimlaneSettings.keyField && !this.parent.isAdaptive) {\n        this.renderSwimlaneRow(tBody, row, isCollaspsed);\n      }\n\n      this.renderSingleContent(tBody, row, isCollaspsed);\n    }\n  };\n\n  LayoutRender.prototype.renderSingleContent = function (tBody, row, isCollaspsed) {\n    var className = isCollaspsed ? cls.CONTENT_ROW_CLASS + ' ' + cls.COLLAPSED_CLASS : cls.CONTENT_ROW_CLASS;\n    var tr = createElement('tr', {\n      className: className,\n      attrs: {\n        'aria-expanded': 'true'\n      }\n    });\n\n    for (var _i = 0, _a = this.parent.columns; _i < _a.length; _i++) {\n      var column = _a[_i];\n\n      if (this.isColumnVisible(column)) {\n        var index = this.parent.actionModule.columnToggleArray.indexOf(column.keyField.toString());\n        var className_1 = index === -1 ? cls.CONTENT_CELLS_CLASS : cls.CONTENT_CELLS_CLASS + ' ' + cls.COLLAPSED_CLASS;\n        var dragClass = (column.allowDrag ? ' ' + cls.DRAG_CLASS : '') + (column.allowDrop ? ' ' + cls.DROP_CLASS + ' ' + cls.DROPPABLE_CLASS : '');\n        var td = createElement('td', {\n          className: className_1 + dragClass,\n          attrs: {\n            'data-role': 'kanban-column',\n            'data-key': column.keyField.toString(),\n            'aria-expanded': 'true',\n            'tabindex': '0',\n            'role': 'navigation'\n          }\n        });\n\n        if (column.allowToggle && !column.isExpanded || index !== -1) {\n          addClass([td], cls.COLLAPSED_CLASS);\n          var text = (column.showItemCount ? '[' + this.getColumnData(column.keyField, this.swimlaneData[row.keyField]).length + '] ' : '') + column.headerText;\n          td.appendChild(createElement('div', {\n            className: cls.COLLAPSE_HEADER_TEXT_CLASS,\n            innerHTML: text\n          }));\n          td.setAttribute('aria-expanded', 'false');\n        }\n\n        if (column.showAddButton) {\n          var button = createElement('div', {\n            className: cls.SHOW_ADD_BUTTON,\n            attrs: {\n              'tabindex': '-1'\n            }\n          });\n          button.appendChild(createElement('div', {\n            className: cls.SHOW_ADD_ICON + ' ' + cls.ICON_CLASS\n          }));\n          td.appendChild(button);\n        }\n\n        tr.appendChild(td);\n      }\n    }\n\n    var dataObj = [{\n      keyField: row.keyField,\n      textField: row.textField,\n      count: row.count\n    }];\n    var args = {\n      data: dataObj,\n      element: tr,\n      cancel: false,\n      requestType: 'contentRow'\n    };\n    this.parent.trigger(events.queryCellInfo, args, function (columnArgs) {\n      if (!columnArgs.cancel) {\n        if (tBody.classList.contains('e-swimlane-row')) {\n          tBody.insertAdjacentElement('beforebegin', tr);\n        } else {\n          tBody.appendChild(tr);\n        }\n      }\n    });\n  };\n\n  LayoutRender.prototype.initializeSwimlaneTree = function () {\n    if (this.parent.swimlaneSettings.keyField && this.parent.isAdaptive && this.parent.kanbanData.length !== 0) {\n      this.swimlaneRow = [this.kanbanRows[this.swimlaneIndex]];\n      this.renderSwimlaneTree();\n      this.parent.element.querySelector('.' + cls.TOOLBAR_SWIMLANE_NAME_CLASS).innerHTML = this.swimlaneRow[0].textField;\n    }\n  };\n\n  LayoutRender.prototype.renderSwimlaneRow = function (tBody, row, isCollapsed) {\n    var name = cls.CONTENT_ROW_CLASS + ' ' + cls.SWIMLANE_ROW_CLASS;\n    var className = isCollapsed ? ' ' + cls.COLLAPSED_CLASS : '';\n    var tr = createElement('tr', {\n      className: name + className,\n      attrs: {\n        'data-key': row.keyField,\n        'aria-expanded': (!isCollapsed).toString()\n      }\n    });\n    var col = this.parent.columns.length - this.parent.actionModule.hideColumnKeys.length;\n    var td = createElement('td', {\n      className: cls.CONTENT_CELLS_CLASS,\n      attrs: {\n        'data-role': 'kanban-column',\n        'colspan': col.toString()\n      }\n    });\n    var swimlaneHeader = createElement('div', {\n      className: cls.SWIMLANE_HEADER_CLASS\n    });\n    td.appendChild(swimlaneHeader);\n    var iconClass = isCollapsed ? cls.SWIMLANE_ROW_COLLAPSE_CLASS : cls.SWIMLANE_ROW_EXPAND_CLASS;\n    var iconDiv = createElement('div', {\n      className: cls.ICON_CLASS + ' ' + iconClass,\n      attrs: {\n        'tabindex': '0',\n        'aria-label': isCollapsed ? row.keyField + ' Collapse' : row.keyField + ' Expand'\n      }\n    });\n    swimlaneHeader.appendChild(iconDiv);\n    var headerWrap = createElement('div', {\n      className: cls.HEADER_WRAP_CLASS\n    });\n    swimlaneHeader.appendChild(headerWrap);\n    var cardCount = this.swimlaneData[row.keyField].length;\n\n    if (this.parent.swimlaneSettings.template) {\n      var templateArgs = extend({}, row, {\n        count: cardCount\n      }, true);\n      addClass([td], cls.TEMPLATE_CLASS);\n      var templateId = this.parent.element.id + '_swimlaneTemplate';\n      var swimlaneTemplate = this.parent.templateParser(this.parent.swimlaneSettings.template)(templateArgs, this.parent, 'swimlaneTemplate', templateId, false);\n      append(swimlaneTemplate, headerWrap);\n    } else {\n      headerWrap.appendChild(createElement('div', {\n        className: cls.SWIMLANE_ROW_TEXT_CLASS,\n        innerHTML: row.textField,\n        attrs: {\n          'data-role': row.textField\n        }\n      }));\n    }\n\n    if (this.parent.swimlaneSettings.showItemCount) {\n      swimlaneHeader.appendChild(createElement('div', {\n        className: cls.CARD_ITEM_COUNT_CLASS,\n        innerHTML: \"- \" + cardCount.toString() + \" \" + this.parent.localeObj.getConstant('items')\n      }));\n    }\n\n    tr.appendChild(td);\n    var dataObj = [{\n      keyField: row.keyField,\n      textField: row.textField,\n      count: row.count\n    }];\n    var args = {\n      data: dataObj,\n      element: tr,\n      cancel: false,\n      requestType: 'swimlaneRow'\n    };\n    this.parent.trigger(events.queryCellInfo, args, function (columnArgs) {\n      if (!columnArgs.cancel) {\n        if (tBody.classList.contains('e-swimlane-row')) {\n          tBody.insertAdjacentElement('beforebegin', tr);\n        } else {\n          tBody.appendChild(tr);\n        }\n      }\n    });\n  };\n\n  LayoutRender.prototype.renderCards = function () {\n    var _this = this;\n\n    var rows = this.swimlaneRow;\n    var cardRows = [].slice.call(this.parent.element.querySelectorAll('.e-content-row:not(.e-swimlane-row)'));\n    var swimlaneRows = [].slice.call(this.parent.element.querySelectorAll('.e-content-row.e-swimlane-row'));\n    var removeTrs = [];\n    cardRows.forEach(function (tr, index) {\n      var dataCount = 0;\n\n      var _loop_2 = function (column) {\n        if (_this.isColumnVisible(column)) {\n          var columnData = _this.parent.swimlaneSettings.keyField ? _this.getColumnData(column.keyField, _this.swimlaneData[rows[index].keyField]) : _this.columnData[column.keyField];\n          dataCount += columnData.length;\n          var columnWrapper = tr.querySelector('[data-key=\"' + column.keyField + '\"]');\n          var cardWrapper_1 = createElement('div', {\n            className: cls.CARD_WRAPPER_CLASS,\n            attrs: {\n              'role': 'listbox'\n            }\n          });\n          columnWrapper.appendChild(cardWrapper_1);\n\n          if (columnData.length > 0) {\n            var _loop_3 = function (data) {\n              var cardText = data[_this.parent.cardSettings.headerField];\n\n              var cardIndex = _this.parent.actionModule.selectionArray.indexOf(cardText);\n\n              var cardElement = _this.renderCard(data);\n\n              if (cardIndex !== -1) {\n                cardElement.setAttribute('aria-selected', 'true');\n                addClass([cardElement], cls.CARD_SELECTION_CLASS);\n              }\n\n              var args = {\n                data: data,\n                element: cardElement,\n                cancel: false\n              };\n\n              _this.parent.trigger(events.cardRendered, args, function (cardArgs) {\n                if (!cardArgs.cancel) {\n                  cardWrapper_1.appendChild(cardElement);\n                }\n              });\n            };\n\n            for (var _i = 0, _a = columnData; _i < _a.length; _i++) {\n              var data = _a[_i];\n\n              _loop_3(data);\n            }\n          } else {\n            cardWrapper_1.appendChild(_this.renderEmptyCard());\n          }\n        }\n      };\n\n      for (var _i = 0, _a = _this.parent.columns; _i < _a.length; _i++) {\n        var column = _a[_i];\n\n        _loop_2(column);\n      }\n\n      if (dataCount === 0) {\n        removeTrs.push(tr);\n\n        if (swimlaneRows.length > 0) {\n          removeTrs.push(swimlaneRows[index]);\n        }\n      }\n    });\n\n    if (!this.parent.swimlaneSettings.showEmptyRow && this.parent.kanbanData.length === 0 && !this.parent.showEmptyColumn) {\n      removeTrs.forEach(function (tr) {\n        return remove(tr);\n      });\n    }\n  };\n\n  LayoutRender.prototype.renderCard = function (data) {\n    var cardElement = createElement('div', {\n      className: cls.CARD_CLASS,\n      attrs: {\n        'data-id': data[this.parent.cardSettings.headerField],\n        'data-key': data[this.parent.keyField],\n        'aria-selected': 'false',\n        'tabindex': '-1',\n        'role': 'option'\n      }\n    });\n\n    if (this.parent.cardSettings.template) {\n      addClass([cardElement], cls.TEMPLATE_CLASS);\n      var templateId = this.parent.element.id + '_cardTemplate';\n      var cardTemplate = this.parent.templateParser(this.parent.cardSettings.template)(data, this.parent, 'cardTemplate', templateId, false);\n      append(cardTemplate, cardElement);\n    } else {\n      var tooltipClass = this.parent.enableTooltip ? ' ' + cls.TOOLTIP_TEXT_CLASS : '';\n\n      if (this.parent.cardSettings.showHeader) {\n        var cardHeader = createElement('div', {\n          className: cls.CARD_HEADER_CLASS\n        });\n        var cardCaption = createElement('div', {\n          className: cls.CARD_HEADER_TEXT_CLASS\n        });\n        var cardText = createElement('div', {\n          className: cls.CARD_HEADER_TITLE_CLASS + tooltipClass,\n          innerHTML: data[this.parent.cardSettings.headerField] || ''\n        });\n        cardHeader.appendChild(cardCaption);\n        cardCaption.appendChild(cardText);\n        cardElement.appendChild(cardHeader);\n      }\n\n      var cardContent = createElement('div', {\n        className: cls.CARD_CONTENT_CLASS + tooltipClass,\n        innerHTML: data[this.parent.cardSettings.contentField] || ''\n      });\n      cardElement.appendChild(cardContent);\n\n      if (this.parent.cardSettings.tagsField && data[this.parent.cardSettings.tagsField]) {\n        var cardTags = createElement('div', {\n          className: cls.CARD_TAGS_CLASS\n        });\n        var tags = data[this.parent.cardSettings.tagsField].toString().split(',');\n\n        for (var _i = 0, tags_1 = tags; _i < tags_1.length; _i++) {\n          var tag = tags_1[_i];\n          cardTags.appendChild(createElement('div', {\n            className: cls.CARD_TAG_CLASS + ' ' + cls.CARD_LABEL_CLASS,\n            innerHTML: tag\n          }));\n        }\n\n        cardElement.appendChild(cardTags);\n      }\n\n      if (this.parent.cardSettings.grabberField && data[this.parent.cardSettings.grabberField]) {\n        addClass([cardElement], cls.CARD_COLOR_CLASS);\n        cardElement.style.borderLeftColor = data[this.parent.cardSettings.grabberField];\n      }\n\n      if (this.parent.cardSettings.footerCssField) {\n        var cardFields = createElement('div', {\n          className: cls.CARD_FOOTER_CLASS\n        });\n        var keys = data[this.parent.cardSettings.footerCssField].split(',');\n\n        for (var _a = 0, keys_1 = keys; _a < keys_1.length; _a++) {\n          var key = keys_1[_a];\n          cardFields.appendChild(createElement('div', {\n            className: key.trim() + ' ' + cls.CARD_FOOTER_CSS_CLASS\n          }));\n        }\n\n        cardElement.appendChild(cardFields);\n      }\n    }\n\n    return cardElement;\n  };\n\n  LayoutRender.prototype.renderEmptyCard = function () {\n    var emptyCard = createElement('span', {\n      className: cls.EMPTY_CARD_CLASS,\n      innerHTML: this.parent.localeObj.getConstant('noCard')\n    });\n    return emptyCard;\n  };\n\n  LayoutRender.prototype.renderColGroup = function (table) {\n    var _this = this;\n\n    var colGroup = createElement('colgroup');\n    this.parent.columns.forEach(function (column) {\n      if (_this.isColumnVisible(column)) {\n        var index = _this.parent.actionModule.columnToggleArray.indexOf(column.keyField.toString());\n\n        var isToggle = column.allowToggle && !column.isExpanded;\n        var className = index === -1 ? isToggle ? cls.COLLAPSED_CLASS : '' : cls.COLLAPSED_CLASS;\n        var col = createElement('col', {\n          className: className,\n          attrs: {\n            'data-key': column.keyField.toString()\n          },\n          styles: _this.parent.isAdaptive ? 'width: ' + (isToggle ? formatUnit(events.toggleWidth) : formatUnit(_this.getWidth())) : ''\n        });\n        colGroup.appendChild(col);\n      }\n    });\n    table.appendChild(colGroup);\n  };\n\n  LayoutRender.prototype.getRows = function () {\n    var _this = this;\n\n    var kanbanRows = [];\n\n    if (this.parent.swimlaneSettings.keyField) {\n      this.parent.kanbanData.map(function (obj) {\n        if (!_this.parent.swimlaneSettings.showEmptyRow) {\n          if (isNullOrUndefined(obj[_this.parent.keyField]) || obj[_this.parent.keyField] === '' || obj[_this.parent.keyField] && _this.columnKeys.indexOf(obj[_this.parent.keyField].toString()) === -1) {\n            return;\n          }\n        }\n\n        var textField = obj[_this.parent.swimlaneSettings.textField] || obj[_this.parent.swimlaneSettings.keyField];\n        var keyField = obj[_this.parent.swimlaneSettings.keyField];\n\n        if (!obj[_this.parent.swimlaneSettings.keyField]) {\n          if (_this.parent.swimlaneSettings.showUnassignedRow) {\n            textField = _this.parent.localeObj.getConstant('unassigned');\n            keyField = '';\n          } else {\n            return;\n          }\n        }\n\n        kanbanRows.push({\n          keyField: keyField,\n          textField: textField\n        });\n      });\n      kanbanRows = kanbanRows.filter(function (item, index, arr) {\n        return index === arr.map(function (item) {\n          return item.keyField;\n        }).indexOf(item.keyField);\n      });\n      kanbanRows = this.swimlaneSorting(kanbanRows);\n      kanbanRows.forEach(function (row) {\n        row.count = _this.parent.kanbanData.filter(function (obj) {\n          return _this.columnKeys.indexOf(obj[_this.parent.keyField]) > -1 && obj[_this.parent.swimlaneSettings.keyField] === row.keyField;\n        }).length;\n      });\n\n      if (kanbanRows.length === 0) {\n        kanbanRows.push({\n          keyField: '',\n          textField: ''\n        });\n      }\n    } else {\n      kanbanRows.push({\n        keyField: '',\n        textField: ''\n      });\n    }\n\n    return kanbanRows;\n  };\n\n  LayoutRender.prototype.swimlaneSorting = function (rows) {\n    if (this.parent.swimlaneSettings.sortComparer) {\n      rows = this.parent.swimlaneSettings.sortComparer.call(this.parent, rows);\n    } else {\n      rows.sort(function (a, b) {\n        return a.textField.localeCompare(b.textField, undefined, {\n          numeric: true\n        });\n      });\n\n      if (this.parent.swimlaneSettings.sortDirection === 'Descending') {\n        rows.reverse();\n      }\n    }\n\n    return rows;\n  };\n\n  LayoutRender.prototype.createStackedRow = function (rows) {\n    var tr = createElement('tr', {\n      className: cls.HEADER_ROW_CLASS + ' ' + cls.STACKED_HEADER_ROW_CLASS\n    });\n    var stackedHeaders = [];\n    this.parent.columns.forEach(function (column) {\n      var headerText = '';\n\n      for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n        var row = rows_1[_i];\n\n        if (row.keyFields.indexOf(column.keyField.toString()) !== -1) {\n          headerText = row.text;\n        }\n      }\n\n      stackedHeaders.push(headerText);\n    });\n\n    for (var h = 0; h < stackedHeaders.length; h++) {\n      var colSpan = 1;\n\n      for (var j = h + 1; j < stackedHeaders.length; j++) {\n        if (stackedHeaders[h] !== '' && stackedHeaders[j] !== '' && stackedHeaders[h] === stackedHeaders[j]) {\n          colSpan++;\n        } else {\n          break;\n        }\n      }\n\n      var div = createElement('div', {\n        className: cls.HEADER_TEXT_CLASS,\n        innerHTML: stackedHeaders[h]\n      });\n      var th = createElement('th', {\n        className: cls.HEADER_CELLS_CLASS + ' ' + cls.STACKED_HEADER_CELL_CLASS,\n        attrs: {\n          'colspan': colSpan.toString()\n        }\n      });\n      tr.appendChild(th).appendChild(div);\n      h += colSpan - 1;\n    }\n\n    return tr;\n  };\n\n  LayoutRender.prototype.scrollUiUpdate = function () {\n    var _this = this;\n\n    var header = this.parent.element.querySelector('.' + cls.HEADER_CLASS);\n    var content = this.parent.element.querySelector('.' + cls.CONTENT_CLASS);\n    var height = this.parent.element.offsetHeight - header.offsetHeight;\n\n    if (this.parent.isAdaptive) {\n      height = window.innerHeight - (header.offsetHeight + events.bottomSpace);\n      var swimlaneToolbar = this.parent.element.querySelector('.' + cls.SWIMLANE_HEADER_CLASS);\n\n      if (swimlaneToolbar) {\n        height -= swimlaneToolbar.offsetHeight;\n      }\n\n      var cardWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CONTENT_CELLS_CLASS));\n      cardWrappers.forEach(function (cell) {\n        var cardWrapper = cell.querySelector('.' + cls.CARD_WRAPPER_CLASS);\n\n        if (!cardWrapper.classList.contains(cls.MULTI_CARD_WRAPPER_CLASS)) {\n          cardWrapper.style.height = formatUnit(height);\n          EventHandler.add(cell, 'touchmove', _this.onAdaptiveScroll, _this);\n        }\n      });\n    }\n\n    if (this.parent.height !== 'auto' && this.parent.height !== '100%') {\n      content.style.height = formatUnit(height);\n    }\n\n    [].slice.call(header.children).forEach(function (node) {\n      var paddingValue = 0;\n\n      if (content.offsetWidth - content.clientWidth > 0) {\n        paddingValue = 17;\n\n        if (content.offsetHeight - content.clientHeight > 0) {\n          node.style.width = formatUnit(content.clientWidth);\n        }\n      }\n\n      if (_this.parent.enableRtl) {\n        node.style.paddingLeft = formatUnit(paddingValue);\n      } else {\n        node.style.paddingRight = formatUnit(paddingValue);\n      }\n    });\n    this.updateScrollPosition();\n  };\n\n  LayoutRender.prototype.onContentScroll = function (e) {\n    var target = e.target;\n    var header = this.parent.element.querySelector('.' + cls.HEADER_CLASS);\n    [].slice.call(header.children).forEach(function (node) {\n      node.scrollLeft = target.scrollLeft;\n    });\n    this.parent.scrollPosition.content = {\n      left: target.scrollLeft,\n      top: target.scrollTop\n    };\n\n    if (!isNullOrUndefined(this.parent.swimlaneSettings.keyField) && this.parent.swimlaneSettings.enableFrozenRows) {\n      this.frozenRows(e);\n    }\n  };\n\n  LayoutRender.prototype.addFrozenSwimlaneDataKey = function (currentElem) {\n    var frozenKey = currentElem.getAttribute('data-key');\n\n    if (!isNullOrUndefined(frozenKey)) {\n      this.frozenSwimlaneRow.setAttribute('data-key', frozenKey);\n    }\n  };\n\n  LayoutRender.prototype.frozenRows = function (e) {\n    var firstSwimlane = this.parent.element.querySelector('.' + cls.SWIMLANE_ROW_CLASS);\n    var header = this.parent.element.querySelector('.' + cls.HEADER_CLASS);\n    var content = this.parent.element.querySelector('.' + cls.CONTENT_CLASS);\n\n    if (isNullOrUndefined(this.frozenSwimlaneRow)) {\n      this.frozenSwimlaneRow = createElement('div', {\n        className: cls.FROZEN_SWIMLANE_ROW_CLASS\n      });\n      var frozenRow = createElement('div', {\n        className: cls.FROZEN_ROW_CLASS\n      });\n      this.frozenSwimlaneRow.appendChild(frozenRow);\n      this.parent.element.insertBefore(this.frozenSwimlaneRow, this.parent.element.firstElementChild);\n      frozenRow.appendChild(firstSwimlane.querySelector('.' + cls.SWIMLANE_HEADER_CLASS).cloneNode(true));\n      this.addFrozenSwimlaneDataKey(firstSwimlane);\n      setStyleAttribute(this.frozenSwimlaneRow, {\n        height: formatUnit(firstSwimlane.getBoundingClientRect().height),\n        width: formatUnit(content.querySelector('.e-swimlane').getBoundingClientRect().width),\n        top: formatUnit(header.getBoundingClientRect().height.toString())\n      });\n      setStyleAttribute(header, {\n        position: 'relative',\n        top: formatUnit(-this.frozenSwimlaneRow.getBoundingClientRect().height)\n      });\n      setStyleAttribute(content, {\n        position: 'relative',\n        top: formatUnit(-this.frozenSwimlaneRow.getBoundingClientRect().height)\n      });\n    } else {\n      var swimlaneRows = [].slice.call(this.parent.element.querySelectorAll('.' + cls.SWIMLANE_ROW_CLASS));\n      var curSwim = swimlaneRows[this.frozenOrder];\n      var prevSwim = swimlaneRows[this.frozenOrder - 1];\n      var nextSwim = swimlaneRows[this.frozenOrder + 1];\n      var curSwimHeight = void 0;\n      var prevSwimHeight = void 0;\n      var nextSwimHeight = void 0;\n\n      if (curSwim) {\n        curSwimHeight = curSwim.getBoundingClientRect().top + curSwim.getBoundingClientRect().height;\n      }\n\n      if (prevSwim) {\n        prevSwimHeight = prevSwim.getBoundingClientRect().top + prevSwim.getBoundingClientRect().height;\n      }\n\n      if (nextSwim) {\n        nextSwimHeight = nextSwim.getBoundingClientRect().top + nextSwim.getBoundingClientRect().height;\n      }\n\n      var frozenSwimHeight = content.getBoundingClientRect().top + this.frozenSwimlaneRow.getBoundingClientRect().height;\n      var frozenRowsElement = this.frozenSwimlaneRow.querySelector('.' + cls.FROZEN_ROW_CLASS);\n\n      if (nextSwimHeight && frozenSwimHeight >= nextSwimHeight && this.frozenOrder < swimlaneRows.length - 1) {\n        if (frozenRowsElement) {\n          remove(frozenRowsElement.querySelector('.' + cls.SWIMLANE_HEADER_CLASS));\n          frozenRowsElement.appendChild(nextSwim.querySelector('.' + cls.SWIMLANE_HEADER_CLASS).cloneNode(true));\n          this.addFrozenSwimlaneDataKey(nextSwim);\n        }\n\n        ++this.frozenOrder;\n      } else if (prevSwimHeight && frozenSwimHeight < curSwimHeight && frozenSwimHeight > prevSwimHeight && this.frozenOrder > 0) {\n        if (frozenRowsElement) {\n          remove(frozenRowsElement.querySelector('.' + cls.SWIMLANE_HEADER_CLASS));\n          frozenRowsElement.appendChild(prevSwim.querySelector('.' + cls.SWIMLANE_HEADER_CLASS).cloneNode(true));\n          this.addFrozenSwimlaneDataKey(prevSwim);\n        }\n\n        --this.frozenOrder;\n      }\n    }\n\n    if (e && e.target.scrollTop == 0) {\n      this.removeFrozenRows();\n    }\n  };\n\n  LayoutRender.prototype.removeFrozenRows = function () {\n    remove(this.frozenSwimlaneRow);\n    this.frozenSwimlaneRow = null;\n    var header = this.parent.element.querySelector('.' + cls.HEADER_CLASS);\n    var content = this.parent.element.querySelector('.' + cls.CONTENT_CLASS);\n    setStyleAttribute(header, {\n      position: '',\n      top: ''\n    });\n    setStyleAttribute(content, {\n      position: '',\n      top: ''\n    });\n    this.parent.scrollPosition.content = {\n      left: this.parent.scrollPosition.content.left,\n      top: 0\n    };\n    content.scrollTop = 0;\n    this.frozenOrder = 0;\n  };\n\n  LayoutRender.prototype.onColumnScroll = function (e) {\n    var target = e.target;\n\n    if (target.offsetParent) {\n      var columnKey = target.offsetParent.getAttribute('data-key');\n      this.parent.scrollPosition.column[columnKey] = {\n        left: target.scrollLeft,\n        top: target.scrollTop\n      };\n    }\n  };\n\n  LayoutRender.prototype.onAdaptiveScroll = function (e) {\n    if (this.parent.touchModule.tabHold && !this.parent.touchModule.mobilePopup) {\n      e.preventDefault();\n    }\n  };\n  /**\n   * Check column is visible or not.\n   *\n   * @param {ColumnsModel} column - specifies the column.\n   * @returns {boolean}\n   * @private\n   * @hidden\n   */\n\n\n  LayoutRender.prototype.isColumnVisible = function (column) {\n    var _this = this;\n\n    var isVisible = false;\n    var isNumeric = typeof column.keyField === 'number';\n\n    if (isNumeric) {\n      isVisible = this.parent.actionModule.hideColumnKeys.indexOf(column.keyField.toString()) === -1;\n    } else {\n      column.keyField.split(',').forEach(function (key) {\n        isVisible = _this.parent.actionModule.hideColumnKeys.indexOf(key) === -1;\n      });\n    }\n\n    return isVisible;\n  };\n\n  LayoutRender.prototype.renderLimits = function (column, target) {\n    var limits = createElement('div', {\n      className: cls.LIMITS_CLASS\n    });\n\n    if (column.minCount) {\n      limits.appendChild(createElement('div', {\n        className: cls.MIN_COUNT_CLASS,\n        innerHTML: this.parent.localeObj.getConstant('min') + ': ' + column.minCount.toString()\n      }));\n    }\n\n    if (column.maxCount) {\n      limits.appendChild(createElement('div', {\n        className: cls.MAX_COUNT_CLASS,\n        innerHTML: this.parent.localeObj.getConstant('max') + ': ' + column.maxCount.toString()\n      }));\n    }\n\n    if (limits.childElementCount > 0) {\n      if (target.querySelector('.' + cls.CARD_WRAPPER_CLASS)) {\n        target.insertBefore(limits, target.firstElementChild);\n      } else {\n        target.appendChild(limits);\n      }\n    }\n  };\n\n  LayoutRender.prototype.renderValidation = function () {\n    var _this = this;\n\n    this.parent.columns.forEach(function (column) {\n      if (!column.minCount && !column.maxCount) {\n        return;\n      }\n\n      var cardData = _this.columnData[column.keyField];\n      var keySelector = \"[data-key=\\\"\" + column.keyField + \"\\\"]\";\n\n      var headerCell = _this.parent.element.querySelector(\".\" + (cls.HEADER_CELLS_CLASS + keySelector));\n\n      var rowCells = [].slice.call(_this.parent.element.querySelectorAll(\".\" + (cls.CONTENT_CELLS_CLASS + keySelector)));\n\n      if (_this.parent.constraintType === 'Swimlane' && _this.parent.swimlaneSettings.keyField) {\n        _this.swimlaneRow.forEach(function (row, index) {\n          _this.renderLimits(column, rowCells[index]);\n\n          var rowCards = cardData.filter(function (card) {\n            return card[_this.parent.swimlaneSettings.keyField] === row.keyField;\n          });\n\n          var colorClass = _this.getValidationClass(column, rowCards.length);\n\n          if (colorClass) {\n            addClass([rowCells[index]], colorClass);\n          }\n        });\n      } else {\n        _this.renderLimits(column, headerCell);\n\n        var colorClass = _this.getValidationClass(column, cardData.length);\n\n        if (colorClass) {\n          addClass(rowCells.concat(headerCell), colorClass);\n        }\n      }\n    });\n  };\n\n  LayoutRender.prototype.getValidationClass = function (column, count) {\n    var colorClass;\n\n    if (column.maxCount && count > column.maxCount) {\n      colorClass = cls.MAX_COLOR_CLASS;\n    } else if (column.minCount && count < column.minCount) {\n      colorClass = cls.MIN_COLOR_CLASS;\n    }\n\n    return colorClass;\n  };\n\n  LayoutRender.prototype.refreshValidation = function () {\n    var validations = [].slice.call(this.parent.element.querySelectorAll('.' + cls.LIMITS_CLASS));\n    validations.forEach(function (node) {\n      remove(node);\n    });\n    var minClass = [].slice.call(this.parent.element.querySelectorAll('.' + cls.MIN_COLOR_CLASS));\n    removeClass(minClass, cls.MIN_COLOR_CLASS);\n    var maxClass = [].slice.call(this.parent.element.querySelectorAll('.' + cls.MAX_COLOR_CLASS));\n    removeClass(maxClass, cls.MAX_COLOR_CLASS);\n    this.renderValidation();\n  };\n\n  LayoutRender.prototype.getColumnData = function (columnValue, dataSource) {\n    var _this = this;\n\n    if (dataSource === void 0) {\n      dataSource = this.parent.kanbanData;\n    }\n\n    var cardData = [];\n    var isNumeric = typeof columnValue === 'number';\n\n    if (isNumeric) {\n      var keyData = dataSource.filter(function (cardObj) {\n        return cardObj[_this.parent.keyField] === columnValue;\n      });\n      cardData = cardData.concat(keyData);\n    } else {\n      var columnKeys = columnValue.split(',');\n\n      var _loop_4 = function (key) {\n        var keyData = dataSource.filter(function (cardObj) {\n          return cardObj[_this.parent.keyField] === key.trim();\n        });\n        cardData = cardData.concat(keyData);\n      };\n\n      for (var _i = 0, columnKeys_1 = columnKeys; _i < columnKeys_1.length; _i++) {\n        var key = columnKeys_1[_i];\n\n        _loop_4(key);\n      }\n    }\n\n    this.sortCategory(cardData);\n    return cardData;\n  };\n\n  LayoutRender.prototype.sortCategory = function (cardData) {\n    var key = this.parent.cardSettings.headerField;\n    var direction = this.parent.sortSettings.direction;\n\n    switch (this.parent.sortSettings.sortBy) {\n      case 'DataSourceOrder':\n        this.sortOrder(key, direction, cardData);\n        break;\n\n      case 'Custom':\n      case 'Index':\n        if (this.parent.sortSettings.field) {\n          key = this.parent.sortSettings.field;\n        }\n\n        this.sortOrder(key, direction, cardData);\n        break;\n    }\n\n    return cardData;\n  };\n\n  LayoutRender.prototype.sortOrder = function (key, direction, cardData) {\n    var isNumeric = true;\n\n    if (this.parent.kanbanData.length > 0) {\n      isNumeric = typeof this.parent.kanbanData[0][key] === 'number';\n    }\n\n    if (!isNumeric && this.parent.sortSettings.sortBy === 'Index') {\n      return cardData;\n    }\n\n    var first;\n    var second;\n    cardData = cardData.sort(function (firstData, secondData) {\n      if (!isNumeric) {\n        first = firstData[key].toLowerCase();\n        second = secondData[key].toLowerCase();\n      } else {\n        first = firstData[key];\n        second = secondData[key];\n      }\n\n      return first > second ? 1 : second > first ? -1 : 0;\n    });\n\n    if (direction === 'Descending') {\n      cardData.reverse();\n    }\n\n    return cardData;\n  };\n\n  LayoutRender.prototype.documentClick = function (args) {\n    if (args.target.classList.contains(cls.SWIMLANE_OVERLAY_CLASS) && this.parent.element.querySelector('.' + cls.SWIMLANE_RESOURCE_CLASS).classList.contains('e-popup-open')) {\n      this.treePopup.hide();\n      removeClass([this.popupOverlay], 'e-enable');\n    }\n\n    if (closest(args.target, \".\" + cls.ROOT_CLASS)) {\n      return;\n    }\n\n    var cards = [].slice.call(this.parent.element.querySelectorAll(\".\" + cls.CARD_CLASS + \".\" + cls.CARD_SELECTION_CLASS));\n    removeClass(cards, cls.CARD_SELECTION_CLASS);\n    this.disableAttributeSelection(cards);\n  };\n\n  LayoutRender.prototype.disableAttributeSelection = function (cards) {\n    if (cards instanceof Element) {\n      cards.setAttribute('aria-selected', 'false');\n    } else {\n      cards.forEach(function (card) {\n        card.setAttribute('aria-selected', 'false');\n      });\n    }\n  };\n\n  LayoutRender.prototype.getColumnCards = function (data) {\n    var _this = this;\n\n    var columnData = {};\n    this.columnKeys = [];\n    this.parent.columns.forEach(function (column) {\n      var isNumeric = typeof column.keyField === 'number';\n\n      if (isNumeric) {\n        _this.columnKeys = _this.columnKeys.concat(column.keyField.toString());\n      } else {\n        _this.columnKeys = _this.columnKeys.concat(column.keyField.split(',').map(function (e) {\n          return e.trim();\n        }));\n      }\n\n      var cardData = _this.getColumnData(column.keyField, data);\n\n      columnData[column.keyField] = cardData;\n    });\n    return columnData;\n  };\n\n  LayoutRender.prototype.getSwimlaneCards = function () {\n    var _this = this;\n\n    var swimlaneData = {};\n\n    if (this.parent.swimlaneSettings.keyField) {\n      this.kanbanRows.forEach(function (row) {\n        return swimlaneData[row.keyField] = _this.parent.kanbanData.filter(function (obj) {\n          return !isNullOrUndefined(obj[_this.parent.keyField]) && _this.columnKeys.indexOf(obj[_this.parent.keyField].toString()) > -1 && (!obj[_this.parent.swimlaneSettings.keyField] && _this.parent.swimlaneSettings.showUnassignedRow ? '' : obj[_this.parent.swimlaneSettings.keyField]) === row.keyField;\n        });\n      });\n    }\n\n    return swimlaneData;\n  };\n\n  LayoutRender.prototype.refreshHeaders = function () {\n    var header = this.parent.element.querySelector('.' + cls.HEADER_CLASS);\n    [].slice.call(header.children).forEach(function (child) {\n      return remove(child);\n    });\n    this.renderHeader(header);\n  };\n\n  LayoutRender.prototype.refreshCards = function () {\n    this.parent.resetTemplates(['cardTemplate']);\n    var cards = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CARD_WRAPPER_CLASS));\n    cards.forEach(function (card) {\n      return remove(card);\n    });\n    this.renderCards();\n    this.wireDragEvent();\n    this.parent.renderTemplates();\n  };\n\n  LayoutRender.prototype.refresh = function () {\n    var _this = this;\n\n    var isColumnTemplateRefreshed = false;\n    this.parent.columns.forEach(function (column) {\n      if (column.showItemCount) {\n        if (column && column.template && !isColumnTemplateRefreshed) {\n          _this.refreshHeaders();\n\n          isColumnTemplateRefreshed = true;\n        }\n\n        var countSelector = \".\" + cls.HEADER_CELLS_CLASS + \"[data-key=\\\"\" + column.keyField + \"\\\"] .\" + cls.CARD_ITEM_COUNT_CLASS;\n\n        var itemCount = _this.parent.element.querySelector(countSelector);\n\n        if (itemCount) {\n          var isNumeric = typeof column.keyField === 'number';\n          var cardLength = 0;\n\n          if (isNumeric) {\n            cardLength = [].slice.call(_this.parent.element.querySelectorAll('.' + cls.CARD_CLASS + '[data-key=\\\"' + column.keyField + '\\\"]')).length;\n          } else {\n            var keys = column.keyField.split(',');\n\n            for (var _i = 0, keys_2 = keys; _i < keys_2.length; _i++) {\n              var key = keys_2[_i];\n              var cards = [].slice.call(_this.parent.element.querySelectorAll('.' + cls.CARD_CLASS + '[data-key=\\\"' + key.trim() + '\\\"]'));\n              cardLength = cards.length + cardLength;\n            }\n          }\n\n          itemCount.innerHTML = '- ' + cardLength + ' ' + _this.parent.localeObj.getConstant('items');\n        }\n      }\n    });\n\n    if (this.parent.swimlaneSettings.keyField) {\n      var swimlaneRows = [].slice.call(this.parent.element.querySelectorAll(\".\" + cls.SWIMLANE_ROW_CLASS));\n      swimlaneRows.forEach(function (swimlane) {\n        var swimlaneKey = swimlane.getAttribute('data-key');\n        var itemCount = swimlane.querySelector(\".\" + cls.CARD_ITEM_COUNT_CLASS);\n\n        if (itemCount && swimlaneKey) {\n          var cards = [].slice.call(swimlane.nextElementSibling.querySelectorAll('.' + cls.CARD_CLASS));\n          itemCount.innerHTML = '- ' + cards.length + ' ' + _this.parent.localeObj.getConstant('items');\n        }\n      });\n    }\n\n    this.refreshValidation();\n  };\n\n  LayoutRender.prototype.updateScrollPosition = function () {\n    var _this = this;\n\n    var content = this.parent.element.querySelector('.' + cls.CONTENT_CLASS);\n\n    if (content) {\n      content.scrollTo(this.parent.scrollPosition.content.left, this.parent.scrollPosition.content.top);\n    }\n\n    var cardWrapper = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CARD_WRAPPER_CLASS));\n    cardWrapper.forEach(function (wrapper) {\n      if (wrapper.offsetParent) {\n        var scrollData = _this.parent.scrollPosition.column[wrapper.offsetParent.getAttribute('data-key')];\n\n        if (scrollData) {\n          wrapper.scrollTo(scrollData.left, scrollData.top);\n        }\n      }\n    });\n  };\n\n  LayoutRender.prototype.renderCardBasedOnIndex = function (data, index) {\n    var _this = this;\n\n    var key = data[this.parent.keyField];\n    var cardRow = this.parent.element.querySelector('.e-content-row:not(.e-swimlane-row)');\n\n    if (this.parent.swimlaneSettings.keyField && !this.parent.isAdaptive) {\n      var rowSelector = \".e-content-row.e-swimlane-row[data-key=\\\"\" + data[this.parent.swimlaneSettings.keyField] + \"\\\"]\";\n\n      if (this.parent.element.querySelector(rowSelector)) {\n        cardRow = this.parent.element.querySelector(rowSelector).nextElementSibling;\n      } else {\n        var columnIndex = this.columnKeys.indexOf(key);\n\n        if (columnIndex !== -1 && this.parent.actionModule.hideColumnKeys.indexOf(key) === -1) {\n          var index_1 = this.kanbanRows.findIndex(function (rowData) {\n            return rowData['keyField'] === data[_this.parent.swimlaneSettings.keyField];\n          });\n          var swim = [].slice.call(this.parent.element.querySelectorAll('.e-swimlane-row'));\n          var swimRow = this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS + ' tbody');\n\n          if (swim[index_1]) {\n            swimRow = swim[index_1];\n          }\n\n          this.renderSwimlaneRow(swimRow, this.kanbanRows[index_1], false);\n          this.renderSingleContent(swimRow, this.kanbanRows[index_1], false);\n        }\n\n        cardRow = this.parent.element.querySelector(rowSelector).nextElementSibling;\n        [].slice.call(cardRow.children).forEach(function (cell) {\n          var cardWrapper = createElement('div', {\n            className: cls.CARD_WRAPPER_CLASS\n          });\n          cell.appendChild(cardWrapper);\n          cardWrapper.appendChild(_this.renderEmptyCard());\n        });\n      }\n    }\n\n    if (this.parent.sortSettings.sortBy !== 'Index') {\n      var field_1 = this.parent.cardSettings.headerField;\n\n      if (this.parent.sortSettings.sortBy === 'Custom') {\n        field_1 = this.parent.sortSettings.field;\n      }\n\n      if (isNullOrUndefined(this.parent.swimlaneSettings.keyField)) {\n        index = this.getColumnData(key, this.parent.kanbanData).findIndex(function (colData) {\n          return colData[field_1] === data[field_1];\n        });\n      } else {\n        var swimlaneDatas = this.parent.getSwimlaneData(data[this.parent.swimlaneSettings.keyField]);\n        index = this.getColumnData(key, swimlaneDatas).findIndex(function (colData) {\n          return colData[field_1] === data[field_1];\n        });\n      }\n    } else if (this.parent.sortSettings.sortBy === 'Index' && this.parent.sortSettings.field && this.parent.sortSettings.direction === 'Ascending') {\n      index = data[this.parent.sortSettings.field] - 1;\n    }\n\n    if (cardRow) {\n      var td = [].slice.call(cardRow.children).filter(function (e) {\n        return e.getAttribute('data-key').replace(/\\s/g, '').split(',').indexOf(key.toString().replace(/\\s/g, '')) !== -1;\n      })[0];\n      var cardWrapper_2 = td.querySelector('.' + cls.CARD_WRAPPER_CLASS);\n      var emptyCard = cardWrapper_2.querySelector('.' + cls.EMPTY_CARD_CLASS);\n\n      if (emptyCard) {\n        remove(emptyCard);\n      }\n\n      var cardElement_1 = this.renderCard(data);\n\n      if (this.parent.allowDragAndDrop && td.classList.contains(cls.DRAG_CLASS)) {\n        this.parent.dragAndDropModule.wireDragEvents(cardElement_1);\n        addClass([cardElement_1], cls.DROPPABLE_CLASS);\n      }\n\n      var args = {\n        data: data,\n        element: cardElement_1,\n        cancel: false\n      };\n      this.parent.trigger(events.cardRendered, args, function (cardArgs) {\n        if (!cardArgs.cancel) {\n          if (isNullOrUndefined(index) || cardWrapper_2.children.length === 0) {\n            cardWrapper_2.appendChild(cardElement_1);\n          } else {\n            cardWrapper_2.insertBefore(cardElement_1, cardWrapper_2.childNodes[index]);\n          }\n        }\n      });\n    }\n  };\n\n  LayoutRender.prototype.removeCard = function (data) {\n    var cardKey = data[this.parent.cardSettings.headerField];\n    var cardElement = this.parent.element.querySelector(\".\" + cls.CARD_CLASS + \"[data-id=\\\"\" + cardKey + \"\\\"]\");\n    this.isSelectedCard = cardElement.classList.contains(cls.CARD_SELECTION_CLASS) ? true : false;\n    var cardContainer = cardElement.parentElement;\n\n    if (cardElement) {\n      remove(cardElement);\n    }\n\n    if (cardContainer.querySelectorAll('.' + cls.CARD_CLASS + ':not(.' + cls.CLONED_CARD_CLASS + ')').length === 0) {\n      cardContainer.appendChild(this.renderEmptyCard());\n    }\n  };\n\n  LayoutRender.prototype.wireEvents = function () {\n    var _this = this;\n\n    EventHandler.add(this.parent.element, 'click', this.parent.actionModule.clickHandler, this.parent.actionModule);\n    EventHandler.add(this.parent.element, 'dblclick', this.parent.actionModule.doubleClickHandler, this.parent.actionModule);\n    EventHandler.add(document, Browser.touchStartEvent, this.documentClick, this);\n    var content = this.parent.element.querySelector('.' + cls.CONTENT_CLASS);\n    EventHandler.add(content, 'scroll', this.onContentScroll, this);\n    var cardWrapper = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CARD_WRAPPER_CLASS));\n    cardWrapper.forEach(function (wrapper) {\n      if (_this.parent.isInitialRender && wrapper.offsetParent) {\n        _this.parent.scrollPosition.column[wrapper.offsetParent.getAttribute('data-key')] = {\n          left: 0,\n          top: 0\n        };\n      }\n\n      EventHandler.add(wrapper, 'scroll', _this.onColumnScroll, _this);\n    });\n\n    if (this.parent.isAdaptive) {\n      this.parent.touchModule.wireTouchEvents();\n      content.scrollLeft = this.scrollLeft;\n    }\n\n    this.wireDragEvent();\n  };\n\n  LayoutRender.prototype.unWireEvents = function () {\n    var _this = this;\n\n    EventHandler.remove(this.parent.element, 'click', this.parent.actionModule.clickHandler);\n    EventHandler.remove(this.parent.element, 'dblclick', this.parent.actionModule.doubleClickHandler);\n    EventHandler.remove(document, Browser.touchStartEvent, this.documentClick);\n    var content = this.parent.element.querySelector('.' + cls.CONTENT_CLASS);\n\n    if (content) {\n      EventHandler.remove(content, 'scroll', this.onContentScroll);\n\n      if (this.parent.allowDragAndDrop) {\n        this.unWireDragEvent();\n      }\n    }\n\n    var cardWrapper = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CARD_WRAPPER_CLASS));\n    cardWrapper.forEach(function (wrapper) {\n      EventHandler.remove(wrapper, 'scroll', _this.onColumnScroll);\n    });\n\n    if (this.parent.isAdaptive) {\n      this.parent.touchModule.unWireTouchEvents();\n    }\n  };\n\n  LayoutRender.prototype.wireDragEvent = function () {\n    var _this = this;\n\n    if (this.parent.allowDragAndDrop) {\n      var cards = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CONTENT_CELLS_CLASS + '.' + cls.DRAG_CLASS + ' .' + cls.CARD_CLASS));\n      addClass(cards, cls.DROPPABLE_CLASS);\n      cards.forEach(function (card) {\n        return _this.parent.dragAndDropModule.wireDragEvents(card);\n      });\n    }\n  };\n\n  LayoutRender.prototype.unWireDragEvent = function () {\n    var _this = this;\n\n    var cards = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CONTENT_CELLS_CLASS + '.' + cls.DRAG_CLASS + ' .' + cls.CARD_CLASS));\n    removeClass(cards, cls.DROPPABLE_CLASS);\n    cards.forEach(function (card) {\n      return _this.parent.dragAndDropModule.unWireDragEvents(card);\n    });\n  };\n\n  LayoutRender.prototype.destroy = function () {\n    this.parent.resetTemplates();\n    this.parent.off(events.dataReady, this.initRender);\n    this.parent.off(events.contentReady, this.scrollUiUpdate);\n    this.unWireEvents();\n    var header = this.parent.element.querySelector('.' + cls.HEADER_CLASS);\n\n    if (header) {\n      remove(header);\n    }\n\n    var content = this.parent.element.querySelector('.' + cls.CONTENT_CLASS);\n\n    if (content) {\n      remove(content);\n    }\n\n    if (this.treeViewObj) {\n      this.treeViewObj.destroy();\n      this.treeViewObj = null;\n    }\n\n    if (this.treePopup) {\n      this.treePopup.destroy();\n      this.treePopup = null;\n    }\n\n    var swimlaneToolBarEle = this.parent.element.querySelector('.' + cls.SWIMLANE_HEADER_CLASS);\n\n    if (swimlaneToolBarEle) {\n      remove(swimlaneToolBarEle);\n    }\n\n    var swimlaneContent = this.parent.element.querySelector('.' + cls.SWIMLANE_CONTENT_CLASS);\n\n    if (swimlaneContent) {\n      remove(swimlaneContent);\n    }\n  };\n\n  return LayoutRender;\n}(MobileLayout);\n\nexport { LayoutRender };","map":{"version":3,"sources":["/Users/altynbekkuat/Desktop/NomaLytics/node_modules/@syncfusion/ej2-kanban/src/kanban/base/layout-render.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","append","createElement","formatUnit","EventHandler","addClass","remove","extend","Browser","isNullOrUndefined","removeClass","closest","setStyleAttribute","MobileLayout","events","cls","LayoutRender","_super","parent","_this","call","kanbanRows","columnKeys","swimlaneIndex","swimlaneData","scrollLeft","frozenOrder","on","dataReady","initRender","contentReady","scrollUiUpdate","columns","length","columnData","getColumnCards","getRows","getSwimlaneCards","isAdaptive","parent_1","element","querySelector","CONTENT_CLASS","destroy","swimlaneSettings","keyField","kanbanData","renderSwimlaneHeader","header","className","HEADER_CLASS","appendChild","renderHeader","renderContent","renderCards","renderValidation","renderTemplates","notify","wireEvents","isInitialRender","headerWrap","SWIMLANE_CLASS","headerTable","TABLE_CLASS","HEADER_TABLE_CLASS","attrs","renderColGroup","tableHead","stackedHeaders","createStackedRow","tr","HEADER_ROW_CLASS","_loop_1","column","this_1","isColumnVisible","index","actionModule","columnToggleArray","indexOf","toString","th_1","HEADER_CELLS_CLASS","COLLAPSED_CLASS","classList","allowToggle","push","HEADER_ROW_TOGGLE_CLASS","isExpanded","headerWrapper","HEADER_WRAP_CLASS","noOfCard","headerTitle","HEADER_TITLE_CLASS","template","templateArgs","headerText","minCount","maxCount","showItemCount","count","TEMPLATE_CLASS","templateId","id","templateHeader","templateParser","header_1","HEADER_TEXT_CLASS","innerHTML","itemCount","CARD_ITEM_COUNT_CLASS","localeObj","getConstant","isExpand","name_1","COLUMN_EXPAND_CLASS","COLUMN_COLLAPSE_CLASS","icon","HEADER_ICON_CLASS","ICON_CLASS","setAttribute","dataObj","textField","args","data","cancel","requestType","trigger","queryCellInfo","columnArgs","_i","_a","content","contentWrap","contentTable","CONTENT_TABLE_CLASS","tBody","isCollaspsed","swimlaneRow","initializeSwimlaneTree","row","swimlaneToggleArray","renderSwimlaneRow","renderSingleContent","CONTENT_ROW_CLASS","className_1","CONTENT_CELLS_CLASS","dragClass","allowDrag","DRAG_CLASS","allowDrop","DROP_CLASS","DROPPABLE_CLASS","td","text","getColumnData","COLLAPSE_HEADER_TEXT_CLASS","showAddButton","button","SHOW_ADD_BUTTON","SHOW_ADD_ICON","contains","insertAdjacentElement","renderSwimlaneTree","TOOLBAR_SWIMLANE_NAME_CLASS","isCollapsed","name","SWIMLANE_ROW_CLASS","col","hideColumnKeys","swimlaneHeader","SWIMLANE_HEADER_CLASS","iconClass","SWIMLANE_ROW_COLLAPSE_CLASS","SWIMLANE_ROW_EXPAND_CLASS","iconDiv","cardCount","swimlaneTemplate","SWIMLANE_ROW_TEXT_CLASS","rows","cardRows","slice","querySelectorAll","swimlaneRows","removeTrs","forEach","dataCount","_loop_2","columnWrapper","cardWrapper_1","CARD_WRAPPER_CLASS","_loop_3","cardText","cardSettings","headerField","cardIndex","selectionArray","cardElement","renderCard","CARD_SELECTION_CLASS","cardRendered","cardArgs","renderEmptyCard","showEmptyRow","showEmptyColumn","CARD_CLASS","cardTemplate","tooltipClass","enableTooltip","TOOLTIP_TEXT_CLASS","showHeader","cardHeader","CARD_HEADER_CLASS","cardCaption","CARD_HEADER_TEXT_CLASS","CARD_HEADER_TITLE_CLASS","cardContent","CARD_CONTENT_CLASS","contentField","tagsField","cardTags","CARD_TAGS_CLASS","tags","split","tags_1","tag","CARD_TAG_CLASS","CARD_LABEL_CLASS","grabberField","CARD_COLOR_CLASS","style","borderLeftColor","footerCssField","cardFields","CARD_FOOTER_CLASS","keys","keys_1","key","trim","CARD_FOOTER_CSS_CLASS","emptyCard","EMPTY_CARD_CLASS","table","colGroup","isToggle","styles","toggleWidth","getWidth","map","obj","showUnassignedRow","filter","item","arr","swimlaneSorting","sortComparer","sort","a","localeCompare","undefined","numeric","sortDirection","reverse","STACKED_HEADER_ROW_CLASS","rows_1","keyFields","h","colSpan","j","div","th","STACKED_HEADER_CELL_CLASS","height","offsetHeight","window","innerHeight","bottomSpace","swimlaneToolbar","cardWrappers","cell","cardWrapper","MULTI_CARD_WRAPPER_CLASS","add","onAdaptiveScroll","children","node","paddingValue","offsetWidth","clientWidth","clientHeight","width","enableRtl","paddingLeft","paddingRight","updateScrollPosition","onContentScroll","e","target","scrollPosition","left","top","scrollTop","enableFrozenRows","frozenRows","addFrozenSwimlaneDataKey","currentElem","frozenKey","getAttribute","frozenSwimlaneRow","firstSwimlane","FROZEN_SWIMLANE_ROW_CLASS","frozenRow","FROZEN_ROW_CLASS","insertBefore","firstElementChild","cloneNode","getBoundingClientRect","position","curSwim","prevSwim","nextSwim","curSwimHeight","prevSwimHeight","nextSwimHeight","frozenSwimHeight","frozenRowsElement","removeFrozenRows","onColumnScroll","offsetParent","columnKey","touchModule","tabHold","mobilePopup","preventDefault","isVisible","isNumeric","renderLimits","limits","LIMITS_CLASS","MIN_COUNT_CLASS","MAX_COUNT_CLASS","childElementCount","cardData","keySelector","headerCell","rowCells","constraintType","rowCards","card","colorClass","getValidationClass","concat","MAX_COLOR_CLASS","MIN_COLOR_CLASS","refreshValidation","validations","minClass","maxClass","columnValue","dataSource","keyData","cardObj","_loop_4","columnKeys_1","sortCategory","direction","sortSettings","sortBy","sortOrder","field","first","second","firstData","secondData","toLowerCase","documentClick","SWIMLANE_OVERLAY_CLASS","SWIMLANE_RESOURCE_CLASS","treePopup","hide","popupOverlay","ROOT_CLASS","cards","disableAttributeSelection","Element","refreshHeaders","child","refreshCards","resetTemplates","wireDragEvent","refresh","isColumnTemplateRefreshed","countSelector","cardLength","keys_2","swimlane","swimlaneKey","nextElementSibling","scrollTo","wrapper","scrollData","renderCardBasedOnIndex","cardRow","rowSelector","columnIndex","index_1","findIndex","rowData","swim","swimRow","field_1","colData","swimlaneDatas","getSwimlaneData","replace","cardWrapper_2","cardElement_1","allowDragAndDrop","dragAndDropModule","wireDragEvents","childNodes","removeCard","cardKey","isSelectedCard","cardContainer","parentElement","CLONED_CARD_CLASS","clickHandler","doubleClickHandler","document","touchStartEvent","wireTouchEvents","unWireEvents","unWireDragEvent","unWireTouchEvents","unWireDragEvents","off","treeViewObj","swimlaneToolBarEle","swimlaneContent","SWIMLANE_CONTENT_CLASS"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { append, createElement, formatUnit, EventHandler, addClass, remove, extend, Browser, isNullOrUndefined, removeClass, closest, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { MobileLayout } from './mobile-layout';\nimport * as events from '../base/constant';\nimport * as cls from '../base/css-constant';\n/**\n * Kanban layout rendering module\n *\n */\nvar LayoutRender = /** @class */ (function (_super) {\n    __extends(LayoutRender, _super);\n    function LayoutRender(parent) {\n        var _this = _super.call(this, parent) || this;\n        _this.kanbanRows = [];\n        _this.parent = parent;\n        _this.columnKeys = [];\n        _this.swimlaneIndex = 0;\n        _this.swimlaneData = {};\n        _this.scrollLeft = 0;\n        _this.frozenOrder = 0;\n        _this.parent.on(events.dataReady, _this.initRender, _this);\n        _this.parent.on(events.contentReady, _this.scrollUiUpdate, _this);\n        return _this;\n    }\n    LayoutRender.prototype.initRender = function () {\n        if (this.parent.columns.length === 0) {\n            return;\n        }\n        this.columnData = this.getColumnCards();\n        this.kanbanRows = this.getRows();\n        this.swimlaneData = this.getSwimlaneCards();\n        if (this.parent.isAdaptive) {\n            var parent_1 = this.parent.element.querySelector('.' + cls.CONTENT_CLASS);\n            if (parent_1) {\n                this.scrollLeft = parent_1.scrollLeft;\n            }\n        }\n        this.destroy();\n        this.parent.on(events.dataReady, this.initRender, this);\n        this.parent.on(events.contentReady, this.scrollUiUpdate, this);\n        if (this.parent.isAdaptive && this.parent.swimlaneSettings.keyField && this.parent.kanbanData.length !== 0) {\n            this.renderSwimlaneHeader();\n        }\n        var header = createElement('div', { className: cls.HEADER_CLASS });\n        this.parent.element.appendChild(header);\n        this.renderHeader(header);\n        this.renderContent();\n        this.renderCards();\n        this.renderValidation();\n        this.parent.renderTemplates();\n        this.parent.notify(events.contentReady, {});\n        this.wireEvents();\n        if (this.parent.isInitialRender) {\n            this.parent.isInitialRender = false;\n        }\n    };\n    LayoutRender.prototype.renderHeader = function (header) {\n        var headerWrap = createElement('div', { className: this.parent.swimlaneSettings.keyField ? cls.SWIMLANE_CLASS : '' });\n        header.appendChild(headerWrap);\n        var headerTable = createElement('table', {\n            className: cls.TABLE_CLASS + ' ' + cls.HEADER_TABLE_CLASS,\n            attrs: { 'role': 'presentation' }\n        });\n        headerWrap.appendChild(headerTable);\n        this.renderColGroup(headerTable);\n        var tableHead = createElement('thead');\n        headerTable.appendChild(tableHead);\n        if (this.parent.stackedHeaders.length > 0) {\n            tableHead.appendChild(this.createStackedRow(this.parent.stackedHeaders));\n        }\n        var tr = createElement('tr', { className: cls.HEADER_ROW_CLASS });\n        tableHead.appendChild(tr);\n        var _loop_1 = function (column) {\n            if (this_1.isColumnVisible(column)) {\n                var index = this_1.parent.actionModule.columnToggleArray.indexOf(column.keyField.toString());\n                var th_1 = createElement('th', {\n                    className: index === -1 ? cls.HEADER_CELLS_CLASS : cls.HEADER_CELLS_CLASS + ' ' + cls.COLLAPSED_CLASS,\n                    attrs: { 'data-role': 'kanban-column', 'data-key': column.keyField.toString() }\n                });\n                var classList = [];\n                if (column.allowToggle) {\n                    classList.push(cls.HEADER_ROW_TOGGLE_CLASS);\n                    if (!column.isExpanded) {\n                        classList.push(cls.COLLAPSED_CLASS);\n                    }\n                }\n                addClass([th_1], classList);\n                var headerWrapper = createElement('div', { className: cls.HEADER_WRAP_CLASS });\n                th_1.appendChild(headerWrapper);\n                var noOfCard = this_1.columnData[column.keyField].length;\n                var headerTitle = createElement('div', { className: cls.HEADER_TITLE_CLASS });\n                headerWrapper.appendChild(headerTitle);\n                if (column.template) {\n                    var templateArgs = {\n                        keyField: column.keyField, headerText: column.headerText, minCount: column.minCount, maxCount: column.maxCount,\n                        allowToggle: column.allowToggle, isExpanded: column.isExpanded, showItemCount: column.showItemCount, count: noOfCard\n                    };\n                    addClass([th_1], cls.TEMPLATE_CLASS);\n                    var templateId = this_1.parent.element.id + '_columnTemplate';\n                    var templateHeader = this_1.parent.templateParser(column.template)(templateArgs, this_1.parent, 'columnTemplate', templateId, false);\n                    append(templateHeader, headerTitle);\n                }\n                else {\n                    var header_1 = createElement('div', { className: cls.HEADER_TEXT_CLASS, innerHTML: column.headerText });\n                    headerTitle.appendChild(header_1);\n                    if (column.showItemCount) {\n                        var itemCount = createElement('div', {\n                            className: cls.CARD_ITEM_COUNT_CLASS,\n                            innerHTML: '- ' + noOfCard.toString() + ' ' + this_1.parent.localeObj.getConstant('items')\n                        });\n                        headerTitle.appendChild(itemCount);\n                    }\n                }\n                if (column.allowToggle) {\n                    var isExpand = (column.isExpanded && index === -1) ? true : false;\n                    var name_1 = (isExpand) ? cls.COLUMN_EXPAND_CLASS : cls.COLUMN_COLLAPSE_CLASS;\n                    var icon = createElement('div', {\n                        className: cls.HEADER_ICON_CLASS + ' ' + cls.ICON_CLASS + ' ' + name_1,\n                        attrs: { 'tabindex': '0' }\n                    });\n                    icon.setAttribute('aria-label', isExpand ? column.keyField + ' Expand' : column.keyField + ' Collapse');\n                    th_1.setAttribute('aria-expanded', isExpand.toString());\n                    headerWrapper.appendChild(icon);\n                }\n                var dataObj = [{ keyField: column.keyField, textField: column.headerText, count: noOfCard }];\n                var args = { data: dataObj, element: tr, cancel: false, requestType: 'headerRow' };\n                this_1.parent.trigger(events.queryCellInfo, args, function (columnArgs) {\n                    if (!columnArgs.cancel) {\n                        tr.appendChild(th_1);\n                    }\n                });\n            }\n        };\n        var this_1 = this;\n        for (var _i = 0, _a = this.parent.columns; _i < _a.length; _i++) {\n            var column = _a[_i];\n            _loop_1(column);\n        }\n    };\n    LayoutRender.prototype.renderContent = function () {\n        var content = createElement('div', { className: cls.CONTENT_CLASS });\n        this.parent.element.appendChild(content);\n        var contentWrap = createElement('div', { className: this.parent.swimlaneSettings.keyField ? cls.SWIMLANE_CLASS : '' });\n        content.appendChild(contentWrap);\n        var contentTable = createElement('table', {\n            className: cls.TABLE_CLASS + ' ' + cls.CONTENT_TABLE_CLASS,\n            attrs: { 'role': 'presentation' }\n        });\n        contentWrap.appendChild(contentTable);\n        this.renderColGroup(contentTable);\n        var tBody = createElement('tbody');\n        contentTable.appendChild(tBody);\n        var className;\n        var isCollaspsed = false;\n        this.swimlaneRow = this.kanbanRows;\n        this.initializeSwimlaneTree();\n        for (var _i = 0, _a = this.swimlaneRow; _i < _a.length; _i++) {\n            var row = _a[_i];\n            if (this.parent.swimlaneSettings.keyField && this.parent.swimlaneToggleArray.length !== 0) {\n                var index = this.parent.swimlaneToggleArray.indexOf(row.keyField);\n                isCollaspsed = index !== -1;\n            }\n            if (this.parent.swimlaneSettings.keyField && !this.parent.isAdaptive) {\n                this.renderSwimlaneRow(tBody, row, isCollaspsed);\n            }\n            this.renderSingleContent(tBody, row, isCollaspsed);\n        }\n    };\n    LayoutRender.prototype.renderSingleContent = function (tBody, row, isCollaspsed) {\n        var className = isCollaspsed ? cls.CONTENT_ROW_CLASS + ' ' + cls.COLLAPSED_CLASS : cls.CONTENT_ROW_CLASS;\n        var tr = createElement('tr', { className: className, attrs: { 'aria-expanded': 'true' } });\n        for (var _i = 0, _a = this.parent.columns; _i < _a.length; _i++) {\n            var column = _a[_i];\n            if (this.isColumnVisible(column)) {\n                var index = this.parent.actionModule.columnToggleArray.indexOf(column.keyField.toString());\n                var className_1 = index === -1 ? cls.CONTENT_CELLS_CLASS : cls.CONTENT_CELLS_CLASS + ' ' + cls.COLLAPSED_CLASS;\n                var dragClass = (column.allowDrag ? ' ' + cls.DRAG_CLASS : '') + (column.allowDrop ? ' ' + cls.DROP_CLASS\n                    + ' ' + cls.DROPPABLE_CLASS : '');\n                var td = createElement('td', {\n                    className: className_1 + dragClass,\n                    attrs: { 'data-role': 'kanban-column', 'data-key': column.keyField.toString(), 'aria-expanded': 'true',\n                        'tabindex': '0', 'role': 'navigation' }\n                });\n                if (column.allowToggle && !column.isExpanded || index !== -1) {\n                    addClass([td], cls.COLLAPSED_CLASS);\n                    var text = (column.showItemCount ? '[' +\n                        this.getColumnData(column.keyField, this.swimlaneData[row.keyField]).length + '] ' : '') + column.headerText;\n                    td.appendChild(createElement('div', { className: cls.COLLAPSE_HEADER_TEXT_CLASS, innerHTML: text }));\n                    td.setAttribute('aria-expanded', 'false');\n                }\n                if (column.showAddButton) {\n                    var button = createElement('div', { className: cls.SHOW_ADD_BUTTON, attrs: { 'tabindex': '-1' } });\n                    button.appendChild(createElement('div', { className: cls.SHOW_ADD_ICON + ' ' + cls.ICON_CLASS }));\n                    td.appendChild(button);\n                }\n                tr.appendChild(td);\n            }\n        }\n        var dataObj = [{ keyField: row.keyField, textField: row.textField, count: row.count }];\n        var args = { data: dataObj, element: tr, cancel: false, requestType: 'contentRow' };\n        this.parent.trigger(events.queryCellInfo, args, function (columnArgs) {\n            if (!columnArgs.cancel) {\n                if (tBody.classList.contains('e-swimlane-row')) {\n                    tBody.insertAdjacentElement('beforebegin', tr);\n                }\n                else {\n                    tBody.appendChild(tr);\n                }\n            }\n        });\n    };\n    LayoutRender.prototype.initializeSwimlaneTree = function () {\n        if (this.parent.swimlaneSettings.keyField && this.parent.isAdaptive && this.parent.kanbanData.length !== 0) {\n            this.swimlaneRow = [this.kanbanRows[this.swimlaneIndex]];\n            this.renderSwimlaneTree();\n            this.parent.element.querySelector('.' + cls.TOOLBAR_SWIMLANE_NAME_CLASS).innerHTML = this.swimlaneRow[0].textField;\n        }\n    };\n    LayoutRender.prototype.renderSwimlaneRow = function (tBody, row, isCollapsed) {\n        var name = cls.CONTENT_ROW_CLASS + ' ' + cls.SWIMLANE_ROW_CLASS;\n        var className = isCollapsed ? ' ' + cls.COLLAPSED_CLASS : '';\n        var tr = createElement('tr', {\n            className: name + className, attrs: { 'data-key': row.keyField, 'aria-expanded': (!isCollapsed).toString() }\n        });\n        var col = this.parent.columns.length - this.parent.actionModule.hideColumnKeys.length;\n        var td = createElement('td', {\n            className: cls.CONTENT_CELLS_CLASS, attrs: { 'data-role': 'kanban-column', 'colspan': col.toString() }\n        });\n        var swimlaneHeader = createElement('div', { className: cls.SWIMLANE_HEADER_CLASS });\n        td.appendChild(swimlaneHeader);\n        var iconClass = isCollapsed ? cls.SWIMLANE_ROW_COLLAPSE_CLASS : cls.SWIMLANE_ROW_EXPAND_CLASS;\n        var iconDiv = createElement('div', {\n            className: cls.ICON_CLASS + ' ' + iconClass, attrs: {\n                'tabindex': '0',\n                'aria-label': isCollapsed ? row.keyField + ' Collapse' : row.keyField + ' Expand'\n            }\n        });\n        swimlaneHeader.appendChild(iconDiv);\n        var headerWrap = createElement('div', { className: cls.HEADER_WRAP_CLASS });\n        swimlaneHeader.appendChild(headerWrap);\n        var cardCount = this.swimlaneData[row.keyField].length;\n        if (this.parent.swimlaneSettings.template) {\n            var templateArgs = extend({}, row, { count: cardCount }, true);\n            addClass([td], cls.TEMPLATE_CLASS);\n            var templateId = this.parent.element.id + '_swimlaneTemplate';\n            var swimlaneTemplate = this.parent.templateParser(this.parent.swimlaneSettings.template)(templateArgs, this.parent, 'swimlaneTemplate', templateId, false);\n            append(swimlaneTemplate, headerWrap);\n        }\n        else {\n            headerWrap.appendChild(createElement('div', {\n                className: cls.SWIMLANE_ROW_TEXT_CLASS,\n                innerHTML: row.textField,\n                attrs: { 'data-role': row.textField }\n            }));\n        }\n        if (this.parent.swimlaneSettings.showItemCount) {\n            swimlaneHeader.appendChild(createElement('div', {\n                className: cls.CARD_ITEM_COUNT_CLASS,\n                innerHTML: \"- \" + cardCount.toString() + \" \" + this.parent.localeObj.getConstant('items')\n            }));\n        }\n        tr.appendChild(td);\n        var dataObj = [{ keyField: row.keyField, textField: row.textField, count: row.count }];\n        var args = { data: dataObj, element: tr, cancel: false, requestType: 'swimlaneRow' };\n        this.parent.trigger(events.queryCellInfo, args, function (columnArgs) {\n            if (!columnArgs.cancel) {\n                if (tBody.classList.contains('e-swimlane-row')) {\n                    tBody.insertAdjacentElement('beforebegin', tr);\n                }\n                else {\n                    tBody.appendChild(tr);\n                }\n            }\n        });\n    };\n    LayoutRender.prototype.renderCards = function () {\n        var _this = this;\n        var rows = this.swimlaneRow;\n        var cardRows = [].slice.call(this.parent.element.querySelectorAll('.e-content-row:not(.e-swimlane-row)'));\n        var swimlaneRows = [].slice.call(this.parent.element.querySelectorAll('.e-content-row.e-swimlane-row'));\n        var removeTrs = [];\n        cardRows.forEach(function (tr, index) {\n            var dataCount = 0;\n            var _loop_2 = function (column) {\n                if (_this.isColumnVisible(column)) {\n                    var columnData = _this.parent.swimlaneSettings.keyField ?\n                        _this.getColumnData(column.keyField, _this.swimlaneData[rows[index].keyField]) : _this.columnData[column.keyField];\n                    dataCount += columnData.length;\n                    var columnWrapper = tr.querySelector('[data-key=\"' + column.keyField + '\"]');\n                    var cardWrapper_1 = createElement('div', {\n                        className: cls.CARD_WRAPPER_CLASS, attrs: { 'role': 'listbox' }\n                    });\n                    columnWrapper.appendChild(cardWrapper_1);\n                    if (columnData.length > 0) {\n                        var _loop_3 = function (data) {\n                            var cardText = data[_this.parent.cardSettings.headerField];\n                            var cardIndex = _this.parent.actionModule.selectionArray.indexOf(cardText);\n                            var cardElement = _this.renderCard(data);\n                            if (cardIndex !== -1) {\n                                cardElement.setAttribute('aria-selected', 'true');\n                                addClass([cardElement], cls.CARD_SELECTION_CLASS);\n                            }\n                            var args = { data: data, element: cardElement, cancel: false };\n                            _this.parent.trigger(events.cardRendered, args, function (cardArgs) {\n                                if (!cardArgs.cancel) {\n                                    cardWrapper_1.appendChild(cardElement);\n                                }\n                            });\n                        };\n                        for (var _i = 0, _a = columnData; _i < _a.length; _i++) {\n                            var data = _a[_i];\n                            _loop_3(data);\n                        }\n                    }\n                    else {\n                        cardWrapper_1.appendChild(_this.renderEmptyCard());\n                    }\n                }\n            };\n            for (var _i = 0, _a = _this.parent.columns; _i < _a.length; _i++) {\n                var column = _a[_i];\n                _loop_2(column);\n            }\n            if (dataCount === 0) {\n                removeTrs.push(tr);\n                if (swimlaneRows.length > 0) {\n                    removeTrs.push(swimlaneRows[index]);\n                }\n            }\n        });\n        if (!this.parent.swimlaneSettings.showEmptyRow && (this.parent.kanbanData.length === 0 && !this.parent.showEmptyColumn)) {\n            removeTrs.forEach(function (tr) { return remove(tr); });\n        }\n    };\n    LayoutRender.prototype.renderCard = function (data) {\n        var cardElement = createElement('div', {\n            className: cls.CARD_CLASS,\n            attrs: {\n                'data-id': data[this.parent.cardSettings.headerField], 'data-key': data[this.parent.keyField],\n                'aria-selected': 'false', 'tabindex': '-1', 'role': 'option'\n            }\n        });\n        if (this.parent.cardSettings.template) {\n            addClass([cardElement], cls.TEMPLATE_CLASS);\n            var templateId = this.parent.element.id + '_cardTemplate';\n            var cardTemplate = this.parent.templateParser(this.parent.cardSettings.template)(data, this.parent, 'cardTemplate', templateId, false);\n            append(cardTemplate, cardElement);\n        }\n        else {\n            var tooltipClass = this.parent.enableTooltip ? ' ' + cls.TOOLTIP_TEXT_CLASS : '';\n            if (this.parent.cardSettings.showHeader) {\n                var cardHeader = createElement('div', { className: cls.CARD_HEADER_CLASS });\n                var cardCaption = createElement('div', { className: cls.CARD_HEADER_TEXT_CLASS });\n                var cardText = createElement('div', {\n                    className: cls.CARD_HEADER_TITLE_CLASS + tooltipClass,\n                    innerHTML: data[this.parent.cardSettings.headerField] || ''\n                });\n                cardHeader.appendChild(cardCaption);\n                cardCaption.appendChild(cardText);\n                cardElement.appendChild(cardHeader);\n            }\n            var cardContent = createElement('div', {\n                className: cls.CARD_CONTENT_CLASS + tooltipClass,\n                innerHTML: data[this.parent.cardSettings.contentField] || ''\n            });\n            cardElement.appendChild(cardContent);\n            if (this.parent.cardSettings.tagsField && data[this.parent.cardSettings.tagsField]) {\n                var cardTags = createElement('div', { className: cls.CARD_TAGS_CLASS });\n                var tags = data[this.parent.cardSettings.tagsField].toString().split(',');\n                for (var _i = 0, tags_1 = tags; _i < tags_1.length; _i++) {\n                    var tag = tags_1[_i];\n                    cardTags.appendChild(createElement('div', {\n                        className: cls.CARD_TAG_CLASS + ' ' + cls.CARD_LABEL_CLASS, innerHTML: tag\n                    }));\n                }\n                cardElement.appendChild(cardTags);\n            }\n            if (this.parent.cardSettings.grabberField && data[this.parent.cardSettings.grabberField]) {\n                addClass([cardElement], cls.CARD_COLOR_CLASS);\n                cardElement.style.borderLeftColor = data[this.parent.cardSettings.grabberField];\n            }\n            if (this.parent.cardSettings.footerCssField) {\n                var cardFields = createElement('div', { className: cls.CARD_FOOTER_CLASS });\n                var keys = data[this.parent.cardSettings.footerCssField].split(',');\n                for (var _a = 0, keys_1 = keys; _a < keys_1.length; _a++) {\n                    var key = keys_1[_a];\n                    cardFields.appendChild(createElement('div', {\n                        className: key.trim() + ' ' + cls.CARD_FOOTER_CSS_CLASS\n                    }));\n                }\n                cardElement.appendChild(cardFields);\n            }\n        }\n        return cardElement;\n    };\n    LayoutRender.prototype.renderEmptyCard = function () {\n        var emptyCard = createElement('span', {\n            className: cls.EMPTY_CARD_CLASS,\n            innerHTML: this.parent.localeObj.getConstant('noCard')\n        });\n        return emptyCard;\n    };\n    LayoutRender.prototype.renderColGroup = function (table) {\n        var _this = this;\n        var colGroup = createElement('colgroup');\n        this.parent.columns.forEach(function (column) {\n            if (_this.isColumnVisible(column)) {\n                var index = _this.parent.actionModule.columnToggleArray.indexOf(column.keyField.toString());\n                var isToggle = column.allowToggle && !column.isExpanded;\n                var className = index === -1 ? (isToggle ? cls.COLLAPSED_CLASS : '') : cls.COLLAPSED_CLASS;\n                var col = createElement('col', {\n                    className: className,\n                    attrs: { 'data-key': column.keyField.toString() },\n                    styles: _this.parent.isAdaptive ? 'width: ' +\n                        (isToggle ? formatUnit(events.toggleWidth) : formatUnit(_this.getWidth())) : ''\n                });\n                colGroup.appendChild(col);\n            }\n        });\n        table.appendChild(colGroup);\n    };\n    LayoutRender.prototype.getRows = function () {\n        var _this = this;\n        var kanbanRows = [];\n        if (this.parent.swimlaneSettings.keyField) {\n            this.parent.kanbanData.map(function (obj) {\n                if (!_this.parent.swimlaneSettings.showEmptyRow) {\n                    if ((isNullOrUndefined(obj[_this.parent.keyField])) || (obj[_this.parent.keyField] === '') ||\n                        (obj[_this.parent.keyField] && _this.columnKeys.indexOf(obj[_this.parent.keyField].toString()) === -1)) {\n                        return;\n                    }\n                }\n                var textField = obj[_this.parent.swimlaneSettings.textField] || obj[_this.parent.swimlaneSettings.keyField];\n                var keyField = obj[_this.parent.swimlaneSettings.keyField];\n                if (!obj[_this.parent.swimlaneSettings.keyField]) {\n                    if (_this.parent.swimlaneSettings.showUnassignedRow) {\n                        textField = _this.parent.localeObj.getConstant('unassigned');\n                        keyField = '';\n                    }\n                    else {\n                        return;\n                    }\n                }\n                kanbanRows.push({ keyField: keyField, textField: textField });\n            });\n            kanbanRows = kanbanRows.filter(function (item, index, arr) {\n                return index === arr.map(function (item) { return item.keyField; }).indexOf(item.keyField);\n            });\n            kanbanRows = this.swimlaneSorting(kanbanRows);\n            kanbanRows.forEach(function (row) {\n                row.count = _this.parent.kanbanData.filter(function (obj) {\n                    return _this.columnKeys.indexOf(obj[_this.parent.keyField]) > -1 &&\n                        obj[_this.parent.swimlaneSettings.keyField] === row.keyField;\n                }).length;\n            });\n            if (kanbanRows.length === 0) {\n                kanbanRows.push({ keyField: '', textField: '' });\n            }\n        }\n        else {\n            kanbanRows.push({ keyField: '', textField: '' });\n        }\n        return kanbanRows;\n    };\n    LayoutRender.prototype.swimlaneSorting = function (rows) {\n        if (this.parent.swimlaneSettings.sortComparer) {\n            rows = this.parent.swimlaneSettings.sortComparer.call(this.parent, rows);\n        }\n        else {\n            rows.sort(function (a, b) { return a.textField.localeCompare(b.textField, undefined, { numeric: true }); });\n            if (this.parent.swimlaneSettings.sortDirection === 'Descending') {\n                rows.reverse();\n            }\n        }\n        return rows;\n    };\n    LayoutRender.prototype.createStackedRow = function (rows) {\n        var tr = createElement('tr', { className: cls.HEADER_ROW_CLASS + ' ' + cls.STACKED_HEADER_ROW_CLASS });\n        var stackedHeaders = [];\n        this.parent.columns.forEach(function (column) {\n            var headerText = '';\n            for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n                var row = rows_1[_i];\n                if (row.keyFields.indexOf(column.keyField.toString()) !== -1) {\n                    headerText = row.text;\n                }\n            }\n            stackedHeaders.push(headerText);\n        });\n        for (var h = 0; h < stackedHeaders.length; h++) {\n            var colSpan = 1;\n            for (var j = h + 1; j < stackedHeaders.length; j++) {\n                if ((stackedHeaders[h] !== '') && (stackedHeaders[j] !== '') && stackedHeaders[h] === stackedHeaders[j]) {\n                    colSpan++;\n                }\n                else {\n                    break;\n                }\n            }\n            var div = createElement('div', { className: cls.HEADER_TEXT_CLASS, innerHTML: stackedHeaders[h] });\n            var th = createElement('th', {\n                className: cls.HEADER_CELLS_CLASS + ' ' + cls.STACKED_HEADER_CELL_CLASS,\n                attrs: { 'colspan': colSpan.toString() }\n            });\n            tr.appendChild(th).appendChild(div);\n            h += colSpan - 1;\n        }\n        return tr;\n    };\n    LayoutRender.prototype.scrollUiUpdate = function () {\n        var _this = this;\n        var header = this.parent.element.querySelector('.' + cls.HEADER_CLASS);\n        var content = this.parent.element.querySelector('.' + cls.CONTENT_CLASS);\n        var height = this.parent.element.offsetHeight - header.offsetHeight;\n        if (this.parent.isAdaptive) {\n            height = window.innerHeight - (header.offsetHeight + events.bottomSpace);\n            var swimlaneToolbar = this.parent.element.querySelector('.' + cls.SWIMLANE_HEADER_CLASS);\n            if (swimlaneToolbar) {\n                height -= swimlaneToolbar.offsetHeight;\n            }\n            var cardWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CONTENT_CELLS_CLASS));\n            cardWrappers.forEach(function (cell) {\n                var cardWrapper = cell.querySelector('.' + cls.CARD_WRAPPER_CLASS);\n                if (!cardWrapper.classList.contains(cls.MULTI_CARD_WRAPPER_CLASS)) {\n                    cardWrapper.style.height = formatUnit(height);\n                    EventHandler.add(cell, 'touchmove', _this.onAdaptiveScroll, _this);\n                }\n            });\n        }\n        if (this.parent.height !== 'auto' && this.parent.height !== '100%') {\n            content.style.height = formatUnit(height);\n        }\n        [].slice.call(header.children).forEach(function (node) {\n            var paddingValue = 0;\n            if ((content.offsetWidth - content.clientWidth) > 0) {\n                paddingValue = 17;\n                if ((content.offsetHeight - content.clientHeight) > 0) {\n                    node.style.width = formatUnit(content.clientWidth);\n                }\n            }\n            if (_this.parent.enableRtl) {\n                node.style.paddingLeft = formatUnit(paddingValue);\n            }\n            else {\n                node.style.paddingRight = formatUnit(paddingValue);\n            }\n        });\n        this.updateScrollPosition();\n    };\n    LayoutRender.prototype.onContentScroll = function (e) {\n        var target = e.target;\n        var header = this.parent.element.querySelector('.' + cls.HEADER_CLASS);\n        [].slice.call(header.children).forEach(function (node) { node.scrollLeft = target.scrollLeft; });\n        this.parent.scrollPosition.content = { left: target.scrollLeft, top: target.scrollTop };\n        if (!isNullOrUndefined(this.parent.swimlaneSettings.keyField) && this.parent.swimlaneSettings.enableFrozenRows) {\n            this.frozenRows(e);\n        }\n    };\n    LayoutRender.prototype.addFrozenSwimlaneDataKey = function (currentElem) {\n        var frozenKey = currentElem.getAttribute('data-key');\n        if (!isNullOrUndefined(frozenKey)) {\n            this.frozenSwimlaneRow.setAttribute('data-key', frozenKey);\n        }\n    };\n    LayoutRender.prototype.frozenRows = function (e) {\n        var firstSwimlane = this.parent.element.querySelector('.' + cls.SWIMLANE_ROW_CLASS);\n        var header = this.parent.element.querySelector('.' + cls.HEADER_CLASS);\n        var content = this.parent.element.querySelector('.' + cls.CONTENT_CLASS);\n        if (isNullOrUndefined(this.frozenSwimlaneRow)) {\n            this.frozenSwimlaneRow = createElement('div', { className: cls.FROZEN_SWIMLANE_ROW_CLASS });\n            var frozenRow = createElement('div', { className: cls.FROZEN_ROW_CLASS });\n            this.frozenSwimlaneRow.appendChild(frozenRow);\n            this.parent.element.insertBefore(this.frozenSwimlaneRow, this.parent.element.firstElementChild);\n            frozenRow.appendChild(firstSwimlane.querySelector('.' + cls.SWIMLANE_HEADER_CLASS).cloneNode(true));\n            this.addFrozenSwimlaneDataKey(firstSwimlane);\n            setStyleAttribute(this.frozenSwimlaneRow, { height: formatUnit(firstSwimlane.getBoundingClientRect().height),\n                width: formatUnit(content.querySelector('.e-swimlane').getBoundingClientRect().width),\n                top: formatUnit(header.getBoundingClientRect().height.toString())\n            });\n            setStyleAttribute(header, { position: 'relative', top: formatUnit((-this.frozenSwimlaneRow.getBoundingClientRect().height)) });\n            setStyleAttribute(content, { position: 'relative', top: formatUnit((-this.frozenSwimlaneRow.getBoundingClientRect().height)) });\n        }\n        else {\n            var swimlaneRows = [].slice.call(this.parent.element.querySelectorAll('.' + cls.SWIMLANE_ROW_CLASS));\n            var curSwim = swimlaneRows[this.frozenOrder];\n            var prevSwim = swimlaneRows[this.frozenOrder - 1];\n            var nextSwim = swimlaneRows[this.frozenOrder + 1];\n            var curSwimHeight = void 0;\n            var prevSwimHeight = void 0;\n            var nextSwimHeight = void 0;\n            if (curSwim) {\n                curSwimHeight = curSwim.getBoundingClientRect().top + curSwim.getBoundingClientRect().height;\n            }\n            if (prevSwim) {\n                prevSwimHeight = prevSwim.getBoundingClientRect().top + prevSwim.getBoundingClientRect().height;\n            }\n            if (nextSwim) {\n                nextSwimHeight = nextSwim.getBoundingClientRect().top + nextSwim.getBoundingClientRect().height;\n            }\n            var frozenSwimHeight = content.getBoundingClientRect().top + this.frozenSwimlaneRow.getBoundingClientRect().height;\n            var frozenRowsElement = this.frozenSwimlaneRow.querySelector('.' + cls.FROZEN_ROW_CLASS);\n            if (nextSwimHeight && frozenSwimHeight >= nextSwimHeight && this.frozenOrder < swimlaneRows.length - 1) {\n                if (frozenRowsElement) {\n                    remove(frozenRowsElement.querySelector('.' + cls.SWIMLANE_HEADER_CLASS));\n                    frozenRowsElement.appendChild(nextSwim.querySelector('.' + cls.SWIMLANE_HEADER_CLASS).cloneNode(true));\n                    this.addFrozenSwimlaneDataKey(nextSwim);\n                }\n                ++this.frozenOrder;\n            }\n            else if (prevSwimHeight && frozenSwimHeight < curSwimHeight && frozenSwimHeight > prevSwimHeight && this.frozenOrder > 0) {\n                if (frozenRowsElement) {\n                    remove(frozenRowsElement.querySelector('.' + cls.SWIMLANE_HEADER_CLASS));\n                    frozenRowsElement.appendChild(prevSwim.querySelector('.' + cls.SWIMLANE_HEADER_CLASS).cloneNode(true));\n                    this.addFrozenSwimlaneDataKey(prevSwim);\n                }\n                --this.frozenOrder;\n            }\n        }\n        if (e && e.target.scrollTop == 0) {\n            this.removeFrozenRows();\n        }\n    };\n    LayoutRender.prototype.removeFrozenRows = function () {\n        remove(this.frozenSwimlaneRow);\n        this.frozenSwimlaneRow = null;\n        var header = this.parent.element.querySelector('.' + cls.HEADER_CLASS);\n        var content = this.parent.element.querySelector('.' + cls.CONTENT_CLASS);\n        setStyleAttribute(header, { position: '', top: '' });\n        setStyleAttribute(content, { position: '', top: '' });\n        this.parent.scrollPosition.content = { left: this.parent.scrollPosition.content.left, top: 0 };\n        content.scrollTop = 0;\n        this.frozenOrder = 0;\n    };\n    LayoutRender.prototype.onColumnScroll = function (e) {\n        var target = e.target;\n        if (target.offsetParent) {\n            var columnKey = target.offsetParent.getAttribute('data-key');\n            this.parent.scrollPosition.column[columnKey] = { left: target.scrollLeft, top: target.scrollTop };\n        }\n    };\n    LayoutRender.prototype.onAdaptiveScroll = function (e) {\n        if (this.parent.touchModule.tabHold && !this.parent.touchModule.mobilePopup) {\n            e.preventDefault();\n        }\n    };\n    /**\n     * Check column is visible or not.\n     *\n     * @param {ColumnsModel} column - specifies the column.\n     * @returns {boolean}\n     * @private\n     * @hidden\n     */\n    LayoutRender.prototype.isColumnVisible = function (column) {\n        var _this = this;\n        var isVisible = false;\n        var isNumeric = typeof column.keyField === 'number';\n        if (isNumeric) {\n            isVisible = this.parent.actionModule.hideColumnKeys.indexOf(column.keyField.toString()) === -1;\n        }\n        else {\n            column.keyField.split(',').forEach(function (key) { isVisible = _this.parent.actionModule.hideColumnKeys.indexOf(key) === -1; });\n        }\n        return isVisible;\n    };\n    LayoutRender.prototype.renderLimits = function (column, target) {\n        var limits = createElement('div', { className: cls.LIMITS_CLASS });\n        if (column.minCount) {\n            limits.appendChild(createElement('div', {\n                className: cls.MIN_COUNT_CLASS,\n                innerHTML: this.parent.localeObj.getConstant('min') + ': ' + column.minCount.toString()\n            }));\n        }\n        if (column.maxCount) {\n            limits.appendChild(createElement('div', {\n                className: cls.MAX_COUNT_CLASS,\n                innerHTML: this.parent.localeObj.getConstant('max') + ': ' + column.maxCount.toString()\n            }));\n        }\n        if (limits.childElementCount > 0) {\n            if (target.querySelector('.' + cls.CARD_WRAPPER_CLASS)) {\n                target.insertBefore(limits, target.firstElementChild);\n            }\n            else {\n                target.appendChild(limits);\n            }\n        }\n    };\n    LayoutRender.prototype.renderValidation = function () {\n        var _this = this;\n        this.parent.columns.forEach(function (column) {\n            if (!column.minCount && !column.maxCount) {\n                return;\n            }\n            var cardData = _this.columnData[column.keyField];\n            var keySelector = \"[data-key=\\\"\" + column.keyField + \"\\\"]\";\n            var headerCell = _this.parent.element.querySelector(\".\" + (cls.HEADER_CELLS_CLASS + keySelector));\n            var rowCells = [].slice.call(_this.parent.element.querySelectorAll(\".\" + (cls.CONTENT_CELLS_CLASS + keySelector)));\n            if (_this.parent.constraintType === 'Swimlane' && _this.parent.swimlaneSettings.keyField) {\n                _this.swimlaneRow.forEach(function (row, index) {\n                    _this.renderLimits(column, rowCells[index]);\n                    var rowCards = cardData.filter(function (card) {\n                        return card[_this.parent.swimlaneSettings.keyField] === row.keyField;\n                    });\n                    var colorClass = _this.getValidationClass(column, rowCards.length);\n                    if (colorClass) {\n                        addClass([rowCells[index]], colorClass);\n                    }\n                });\n            }\n            else {\n                _this.renderLimits(column, headerCell);\n                var colorClass = _this.getValidationClass(column, cardData.length);\n                if (colorClass) {\n                    addClass(rowCells.concat(headerCell), colorClass);\n                }\n            }\n        });\n    };\n    LayoutRender.prototype.getValidationClass = function (column, count) {\n        var colorClass;\n        if (column.maxCount && count > column.maxCount) {\n            colorClass = cls.MAX_COLOR_CLASS;\n        }\n        else if (column.minCount && count < column.minCount) {\n            colorClass = cls.MIN_COLOR_CLASS;\n        }\n        return colorClass;\n    };\n    LayoutRender.prototype.refreshValidation = function () {\n        var validations = [].slice.call(this.parent.element.querySelectorAll('.' + cls.LIMITS_CLASS));\n        validations.forEach(function (node) { remove(node); });\n        var minClass = [].slice.call(this.parent.element.querySelectorAll('.' + cls.MIN_COLOR_CLASS));\n        removeClass(minClass, cls.MIN_COLOR_CLASS);\n        var maxClass = [].slice.call(this.parent.element.querySelectorAll('.' + cls.MAX_COLOR_CLASS));\n        removeClass(maxClass, cls.MAX_COLOR_CLASS);\n        this.renderValidation();\n    };\n    LayoutRender.prototype.getColumnData = function (columnValue, dataSource) {\n        var _this = this;\n        if (dataSource === void 0) { dataSource = this.parent.kanbanData; }\n        var cardData = [];\n        var isNumeric = typeof columnValue === 'number';\n        if (isNumeric) {\n            var keyData = dataSource.filter(function (cardObj) {\n                return cardObj[_this.parent.keyField] === columnValue;\n            });\n            cardData = cardData.concat(keyData);\n        }\n        else {\n            var columnKeys = columnValue.split(',');\n            var _loop_4 = function (key) {\n                var keyData = dataSource.filter(function (cardObj) {\n                    return cardObj[_this.parent.keyField] === key.trim();\n                });\n                cardData = cardData.concat(keyData);\n            };\n            for (var _i = 0, columnKeys_1 = columnKeys; _i < columnKeys_1.length; _i++) {\n                var key = columnKeys_1[_i];\n                _loop_4(key);\n            }\n        }\n        this.sortCategory(cardData);\n        return cardData;\n    };\n    LayoutRender.prototype.sortCategory = function (cardData) {\n        var key = this.parent.cardSettings.headerField;\n        var direction = this.parent.sortSettings.direction;\n        switch (this.parent.sortSettings.sortBy) {\n            case 'DataSourceOrder':\n                this.sortOrder(key, direction, cardData);\n                break;\n            case 'Custom':\n            case 'Index':\n                if (this.parent.sortSettings.field) {\n                    key = this.parent.sortSettings.field;\n                }\n                this.sortOrder(key, direction, cardData);\n                break;\n        }\n        return cardData;\n    };\n    LayoutRender.prototype.sortOrder = function (key, direction, cardData) {\n        var isNumeric = true;\n        if (this.parent.kanbanData.length > 0) {\n            isNumeric = typeof (this.parent.kanbanData[0])[key] === 'number';\n        }\n        if (!isNumeric && this.parent.sortSettings.sortBy === 'Index') {\n            return cardData;\n        }\n        var first;\n        var second;\n        cardData = cardData.sort(function (firstData, secondData) {\n            if (!isNumeric) {\n                first = firstData[key].toLowerCase();\n                second = secondData[key].toLowerCase();\n            }\n            else {\n                first = firstData[key];\n                second = secondData[key];\n            }\n            return (first > second) ? 1 : ((second > first) ? -1 : 0);\n        });\n        if (direction === 'Descending') {\n            cardData.reverse();\n        }\n        return cardData;\n    };\n    LayoutRender.prototype.documentClick = function (args) {\n        if (args.target.classList.contains(cls.SWIMLANE_OVERLAY_CLASS) &&\n            this.parent.element.querySelector('.' + cls.SWIMLANE_RESOURCE_CLASS).classList.contains('e-popup-open')) {\n            this.treePopup.hide();\n            removeClass([this.popupOverlay], 'e-enable');\n        }\n        if (closest(args.target, \".\" + cls.ROOT_CLASS)) {\n            return;\n        }\n        var cards = [].slice.call(this.parent.element.querySelectorAll(\".\" + cls.CARD_CLASS + \".\" + cls.CARD_SELECTION_CLASS));\n        removeClass(cards, cls.CARD_SELECTION_CLASS);\n        this.disableAttributeSelection(cards);\n    };\n    LayoutRender.prototype.disableAttributeSelection = function (cards) {\n        if (cards instanceof Element) {\n            cards.setAttribute('aria-selected', 'false');\n        }\n        else {\n            cards.forEach(function (card) { card.setAttribute('aria-selected', 'false'); });\n        }\n    };\n    LayoutRender.prototype.getColumnCards = function (data) {\n        var _this = this;\n        var columnData = {};\n        this.columnKeys = [];\n        this.parent.columns.forEach(function (column) {\n            var isNumeric = typeof column.keyField === 'number';\n            if (isNumeric) {\n                _this.columnKeys = _this.columnKeys.concat(column.keyField.toString());\n            }\n            else {\n                _this.columnKeys = _this.columnKeys.concat(column.keyField.split(',').map(function (e) { return e.trim(); }));\n            }\n            var cardData = _this.getColumnData(column.keyField, data);\n            columnData[column.keyField] = cardData;\n        });\n        return columnData;\n    };\n    LayoutRender.prototype.getSwimlaneCards = function () {\n        var _this = this;\n        var swimlaneData = {};\n        if (this.parent.swimlaneSettings.keyField) {\n            this.kanbanRows.forEach(function (row) {\n                return swimlaneData[row.keyField] = _this.parent.kanbanData.filter(function (obj) {\n                    return !isNullOrUndefined(obj[_this.parent.keyField]) && _this.columnKeys.indexOf(obj[_this.parent.keyField].toString()) > -1 &&\n                        ((!obj[_this.parent.swimlaneSettings.keyField] && _this.parent.swimlaneSettings.showUnassignedRow) ?\n                            '' : obj[_this.parent.swimlaneSettings.keyField]) === row.keyField;\n                });\n            });\n        }\n        return swimlaneData;\n    };\n    LayoutRender.prototype.refreshHeaders = function () {\n        var header = this.parent.element.querySelector('.' + cls.HEADER_CLASS);\n        [].slice.call(header.children).forEach(function (child) { return remove(child); });\n        this.renderHeader(header);\n    };\n    LayoutRender.prototype.refreshCards = function () {\n        this.parent.resetTemplates(['cardTemplate']);\n        var cards = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CARD_WRAPPER_CLASS));\n        cards.forEach(function (card) { return remove(card); });\n        this.renderCards();\n        this.wireDragEvent();\n        this.parent.renderTemplates();\n    };\n    LayoutRender.prototype.refresh = function () {\n        var _this = this;\n        var isColumnTemplateRefreshed = false;\n        this.parent.columns.forEach(function (column) {\n            if (column.showItemCount) {\n                if (column && column.template && !isColumnTemplateRefreshed) {\n                    _this.refreshHeaders();\n                    isColumnTemplateRefreshed = true;\n                }\n                var countSelector = \".\" + cls.HEADER_CELLS_CLASS + \"[data-key=\\\"\" + column.keyField + \"\\\"] .\" + cls.CARD_ITEM_COUNT_CLASS;\n                var itemCount = _this.parent.element.querySelector(countSelector);\n                if (itemCount) {\n                    var isNumeric = typeof column.keyField === 'number';\n                    var cardLength = 0;\n                    if (isNumeric) {\n                        cardLength = ([].slice.call(_this.parent.element.querySelectorAll('.' + cls.CARD_CLASS + '[data-key=\\\"' + column.keyField + '\\\"]'))).length;\n                    }\n                    else {\n                        var keys = column.keyField.split(',');\n                        for (var _i = 0, keys_2 = keys; _i < keys_2.length; _i++) {\n                            var key = keys_2[_i];\n                            var cards = [].slice.call(_this.parent.element.querySelectorAll('.' + cls.CARD_CLASS + '[data-key=\\\"' + key.trim() + '\\\"]'));\n                            cardLength = cards.length + cardLength;\n                        }\n                    }\n                    itemCount.innerHTML = '- ' + cardLength + ' ' + _this.parent.localeObj.getConstant('items');\n                }\n            }\n        });\n        if (this.parent.swimlaneSettings.keyField) {\n            var swimlaneRows = [].slice.call(this.parent.element.querySelectorAll(\".\" + cls.SWIMLANE_ROW_CLASS));\n            swimlaneRows.forEach(function (swimlane) {\n                var swimlaneKey = swimlane.getAttribute('data-key');\n                var itemCount = swimlane.querySelector(\".\" + cls.CARD_ITEM_COUNT_CLASS);\n                if (itemCount && swimlaneKey) {\n                    var cards = [].slice.call(swimlane.nextElementSibling.querySelectorAll('.' + cls.CARD_CLASS));\n                    itemCount.innerHTML = '- ' + cards.length + ' ' + _this.parent.localeObj.getConstant('items');\n                }\n            });\n        }\n        this.refreshValidation();\n    };\n    LayoutRender.prototype.updateScrollPosition = function () {\n        var _this = this;\n        var content = this.parent.element.querySelector('.' + cls.CONTENT_CLASS);\n        if (content) {\n            content.scrollTo(this.parent.scrollPosition.content.left, this.parent.scrollPosition.content.top);\n        }\n        var cardWrapper = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CARD_WRAPPER_CLASS));\n        cardWrapper.forEach(function (wrapper) {\n            if (wrapper.offsetParent) {\n                var scrollData = _this.parent.scrollPosition.column[wrapper.offsetParent.getAttribute('data-key')];\n                if (scrollData) {\n                    wrapper.scrollTo(scrollData.left, scrollData.top);\n                }\n            }\n        });\n    };\n    LayoutRender.prototype.renderCardBasedOnIndex = function (data, index) {\n        var _this = this;\n        var key = data[this.parent.keyField];\n        var cardRow = this.parent.element.querySelector('.e-content-row:not(.e-swimlane-row)');\n        if (this.parent.swimlaneSettings.keyField && !this.parent.isAdaptive) {\n            var rowSelector = \".e-content-row.e-swimlane-row[data-key=\\\"\" + data[this.parent.swimlaneSettings.keyField] + \"\\\"]\";\n            if (this.parent.element.querySelector(rowSelector)) {\n                cardRow = this.parent.element.querySelector(rowSelector).nextElementSibling;\n            }\n            else {\n                var columnIndex = this.columnKeys.indexOf(key);\n                if (columnIndex !== -1 && this.parent.actionModule.hideColumnKeys.indexOf(key) === -1) {\n                    var index_1 = this.kanbanRows.findIndex(function (rowData) { return rowData['keyField'] === data[_this.parent.swimlaneSettings.keyField]; });\n                    var swim = [].slice.call(this.parent.element.querySelectorAll('.e-swimlane-row'));\n                    var swimRow = this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS + ' tbody');\n                    if (swim[index_1]) {\n                        swimRow = swim[index_1];\n                    }\n                    this.renderSwimlaneRow(swimRow, this.kanbanRows[index_1], false);\n                    this.renderSingleContent(swimRow, this.kanbanRows[index_1], false);\n                }\n                cardRow = this.parent.element.querySelector(rowSelector).nextElementSibling;\n                [].slice.call(cardRow.children).forEach(function (cell) {\n                    var cardWrapper = createElement('div', { className: cls.CARD_WRAPPER_CLASS });\n                    cell.appendChild(cardWrapper);\n                    cardWrapper.appendChild(_this.renderEmptyCard());\n                });\n            }\n        }\n        if (this.parent.sortSettings.sortBy !== 'Index') {\n            var field_1 = this.parent.cardSettings.headerField;\n            if (this.parent.sortSettings.sortBy === 'Custom') {\n                field_1 = this.parent.sortSettings.field;\n            }\n            if (isNullOrUndefined(this.parent.swimlaneSettings.keyField)) {\n                index = this.getColumnData(key, this.parent.kanbanData).findIndex(function (colData) {\n                    return colData[field_1] === data[field_1];\n                });\n            }\n            else {\n                var swimlaneDatas = this.parent.getSwimlaneData(data[this.parent.swimlaneSettings.keyField]);\n                index = this.getColumnData(key, swimlaneDatas).findIndex(function (colData) { return colData[field_1] === data[field_1]; });\n            }\n        }\n        else if (this.parent.sortSettings.sortBy === 'Index' &&\n            this.parent.sortSettings.field && this.parent.sortSettings.direction === 'Ascending') {\n            index = data[this.parent.sortSettings.field] - 1;\n        }\n        if (cardRow) {\n            var td = [].slice.call(cardRow.children).filter(function (e) {\n                return e.getAttribute('data-key').replace(/\\s/g, '').split(',').indexOf(key.toString().replace(/\\s/g, '')) !== -1;\n            })[0];\n            var cardWrapper_2 = td.querySelector('.' + cls.CARD_WRAPPER_CLASS);\n            var emptyCard = cardWrapper_2.querySelector('.' + cls.EMPTY_CARD_CLASS);\n            if (emptyCard) {\n                remove(emptyCard);\n            }\n            var cardElement_1 = this.renderCard(data);\n            if (this.parent.allowDragAndDrop && td.classList.contains(cls.DRAG_CLASS)) {\n                this.parent.dragAndDropModule.wireDragEvents(cardElement_1);\n                addClass([cardElement_1], cls.DROPPABLE_CLASS);\n            }\n            var args = { data: data, element: cardElement_1, cancel: false };\n            this.parent.trigger(events.cardRendered, args, function (cardArgs) {\n                if (!cardArgs.cancel) {\n                    if (isNullOrUndefined(index) || cardWrapper_2.children.length === 0) {\n                        cardWrapper_2.appendChild(cardElement_1);\n                    }\n                    else {\n                        cardWrapper_2.insertBefore(cardElement_1, cardWrapper_2.childNodes[index]);\n                    }\n                }\n            });\n        }\n    };\n    LayoutRender.prototype.removeCard = function (data) {\n        var cardKey = data[this.parent.cardSettings.headerField];\n        var cardElement = this.parent.element.querySelector(\".\" + cls.CARD_CLASS + \"[data-id=\\\"\" + cardKey + \"\\\"]\");\n        this.isSelectedCard = cardElement.classList.contains(cls.CARD_SELECTION_CLASS) ? true : false;\n        var cardContainer = cardElement.parentElement;\n        if (cardElement) {\n            remove(cardElement);\n        }\n        if (cardContainer.querySelectorAll('.' + cls.CARD_CLASS + ':not(.' + cls.CLONED_CARD_CLASS + ')').length === 0) {\n            cardContainer.appendChild(this.renderEmptyCard());\n        }\n    };\n    LayoutRender.prototype.wireEvents = function () {\n        var _this = this;\n        EventHandler.add(this.parent.element, 'click', this.parent.actionModule.clickHandler, this.parent.actionModule);\n        EventHandler.add(this.parent.element, 'dblclick', this.parent.actionModule.doubleClickHandler, this.parent.actionModule);\n        EventHandler.add(document, Browser.touchStartEvent, this.documentClick, this);\n        var content = this.parent.element.querySelector('.' + cls.CONTENT_CLASS);\n        EventHandler.add(content, 'scroll', this.onContentScroll, this);\n        var cardWrapper = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CARD_WRAPPER_CLASS));\n        cardWrapper.forEach(function (wrapper) {\n            if (_this.parent.isInitialRender && wrapper.offsetParent) {\n                _this.parent.scrollPosition.column[wrapper.offsetParent.getAttribute('data-key')] = { left: 0, top: 0 };\n            }\n            EventHandler.add(wrapper, 'scroll', _this.onColumnScroll, _this);\n        });\n        if (this.parent.isAdaptive) {\n            this.parent.touchModule.wireTouchEvents();\n            content.scrollLeft = this.scrollLeft;\n        }\n        this.wireDragEvent();\n    };\n    LayoutRender.prototype.unWireEvents = function () {\n        var _this = this;\n        EventHandler.remove(this.parent.element, 'click', this.parent.actionModule.clickHandler);\n        EventHandler.remove(this.parent.element, 'dblclick', this.parent.actionModule.doubleClickHandler);\n        EventHandler.remove(document, Browser.touchStartEvent, this.documentClick);\n        var content = this.parent.element.querySelector('.' + cls.CONTENT_CLASS);\n        if (content) {\n            EventHandler.remove(content, 'scroll', this.onContentScroll);\n            if (this.parent.allowDragAndDrop) {\n                this.unWireDragEvent();\n            }\n        }\n        var cardWrapper = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CARD_WRAPPER_CLASS));\n        cardWrapper.forEach(function (wrapper) { EventHandler.remove(wrapper, 'scroll', _this.onColumnScroll); });\n        if (this.parent.isAdaptive) {\n            this.parent.touchModule.unWireTouchEvents();\n        }\n    };\n    LayoutRender.prototype.wireDragEvent = function () {\n        var _this = this;\n        if (this.parent.allowDragAndDrop) {\n            var cards = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CONTENT_CELLS_CLASS\n                + '.' + cls.DRAG_CLASS + ' .' + cls.CARD_CLASS));\n            addClass(cards, cls.DROPPABLE_CLASS);\n            cards.forEach(function (card) { return _this.parent.dragAndDropModule.wireDragEvents(card); });\n        }\n    };\n    LayoutRender.prototype.unWireDragEvent = function () {\n        var _this = this;\n        var cards = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CONTENT_CELLS_CLASS\n            + '.' + cls.DRAG_CLASS + ' .' + cls.CARD_CLASS));\n        removeClass(cards, cls.DROPPABLE_CLASS);\n        cards.forEach(function (card) { return _this.parent.dragAndDropModule.unWireDragEvents(card); });\n    };\n    LayoutRender.prototype.destroy = function () {\n        this.parent.resetTemplates();\n        this.parent.off(events.dataReady, this.initRender);\n        this.parent.off(events.contentReady, this.scrollUiUpdate);\n        this.unWireEvents();\n        var header = this.parent.element.querySelector('.' + cls.HEADER_CLASS);\n        if (header) {\n            remove(header);\n        }\n        var content = this.parent.element.querySelector('.' + cls.CONTENT_CLASS);\n        if (content) {\n            remove(content);\n        }\n        if (this.treeViewObj) {\n            this.treeViewObj.destroy();\n            this.treeViewObj = null;\n        }\n        if (this.treePopup) {\n            this.treePopup.destroy();\n            this.treePopup = null;\n        }\n        var swimlaneToolBarEle = this.parent.element.querySelector('.' + cls.SWIMLANE_HEADER_CLASS);\n        if (swimlaneToolBarEle) {\n            remove(swimlaneToolBarEle);\n        }\n        var swimlaneContent = this.parent.element.querySelector('.' + cls.SWIMLANE_CONTENT_CLASS);\n        if (swimlaneContent) {\n            remove(swimlaneContent);\n        }\n    };\n    return LayoutRender;\n}(MobileLayout));\nexport { LayoutRender };\n"]},"metadata":{},"sourceType":"module"}